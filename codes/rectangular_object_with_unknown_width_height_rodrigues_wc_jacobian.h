inline void rectangular_object_with_unknown_width_height_rodrigues_wc(Eigen::Matrix<double, 2, 1> &delta, double px, double py, double pz, double sx, double sy, double sz, double xsl, double ysl, double zsl, double xtg, double ytg, double ztg, double vxx, double vxy, double vxz, double vyx, double vyy, double vyz, double scale_x, double scale_y)
{delta.coeffRef(0,0) = -vxx*(px + scale_x*xsl*(pow(sx, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) + scale_y*ysl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) - xtg + zsl*(sx*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxy*(py + scale_x*xsl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - ytg + zsl*(-sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxz*(pz + scale_x*xsl*(sx*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - ztg);
delta.coeffRef(1,0) = -vyx*(px + scale_x*xsl*(pow(sx, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) + scale_y*ysl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) - xtg + zsl*(sx*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyy*(py + scale_x*xsl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - ytg + zsl*(-sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyz*(pz + scale_x*xsl*(sx*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - ztg);
}
inline void rectangular_object_with_unknown_width_height_rodrigues_wc_jacobian(Eigen::Matrix<double, 2, 8> &j, double px, double py, double pz, double sx, double sy, double sz, double xsl, double ysl, double zsl, double xtg, double ytg, double ztg, double vxx, double vxy, double vxz, double vyx, double vyy, double vyz, double scale_x, double scale_y)
{j.coeffRef(0,0) = -vxx;
j.coeffRef(0,1) = -vxy;
j.coeffRef(0,2) = -vxz;
j.coeffRef(0,3) = -vxx*(scale_x*xsl*(-2*pow(sx, 3)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 3)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + 2*sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*pow(sx, 2)*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*pow(sx, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxy*(scale_x*xsl*(-2*pow(sx, 2)*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*sx*pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-pow(sx, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + pow(sx, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxz*(scale_x*xsl*(-2*pow(sx, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(pow(sx, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - pow(sx, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*sx*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))));
j.coeffRef(0,4) = -vxx*(scale_x*xsl*(-2*pow(sx, 2)*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*sx*pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0)) + zsl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + pow(sy, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxy*(scale_x*xsl*(-2*sx*pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0)) + scale_y*ysl*(-2*pow(sy, 3)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 3)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + 2*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*pow(sy, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxz*(scale_x*xsl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - pow(sy, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*pow(sy, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*sy*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sy*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))));
j.coeffRef(0,5) = -vxx*(scale_x*xsl*(-2*pow(sx, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - pow(sz, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*sx*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0))) - vxy*(scale_x*xsl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + pow(sz, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*pow(sy, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sy*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sy*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxz*(scale_x*xsl*(-2*sx*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0)) + scale_y*ysl*(sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sy*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sy*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*pow(sz, 3)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sz, 3)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + 2*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))));
j.coeffRef(0,6) = -vxx*xsl*(pow(sx, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxy*xsl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) - vxz*xsl*(sx*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)));
j.coeffRef(0,7) = -vxx*ysl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) - vxy*ysl*(pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vxz*ysl*(sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)));
j.coeffRef(1,0) = -vyx;
j.coeffRef(1,1) = -vyy;
j.coeffRef(1,2) = -vyz;
j.coeffRef(1,3) = -vyx*(scale_x*xsl*(-2*pow(sx, 3)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 3)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + 2*sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*pow(sx, 2)*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*pow(sx, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyy*(scale_x*xsl*(-2*pow(sx, 2)*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*sx*pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-pow(sx, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + pow(sx, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyz*(scale_x*xsl*(-2*pow(sx, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(pow(sx, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - pow(sx, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*sx*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))));
j.coeffRef(1,4) = -vyx*(scale_x*xsl*(-2*pow(sx, 2)*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*sx*pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0)) + zsl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + pow(sy, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyy*(scale_x*xsl*(-2*sx*pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0)) + scale_y*ysl*(-2*pow(sy, 3)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 3)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + 2*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*pow(sy, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyz*(scale_x*xsl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - pow(sy, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + pow(sy, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(sx*sy*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*pow(sy, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*sy*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sy*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))));
j.coeffRef(1,5) = -vyx*(scale_x*xsl*(-2*pow(sx, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sx, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - pow(sz, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*sx*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0))) - vyy*(scale_x*xsl*(-2*sx*sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + pow(sz, 2)*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + scale_y*ysl*(-2*pow(sy, 2)*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sy, 2)*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sy*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sy*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyz*(scale_x*xsl*(-2*sx*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sx*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sx*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0)) + scale_y*ysl*(sx*sz*cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sx*sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) - 2*sy*pow(sz, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + sy*pow(sz, 2)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) + zsl*(-2*pow(sz, 3)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 2) + pow(sz, 3)*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/pow(pow(sx, 2) + pow(sy, 2) + pow(sz, 2), 3.0/2.0) + 2*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))));
j.coeffRef(1,6) = -vyx*xsl*(pow(sx, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyy*xsl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) - vyz*xsl*(sx*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sy*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)));
j.coeffRef(1,7) = -vyx*ysl*(sx*sy*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) - sz*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))) - vyy*ysl*(pow(sy, 2)*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))) - vyz*ysl*(sx*sin(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)))/sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)) + sy*sz*(1.0 - cos(sqrt(pow(sx, 2) + pow(sy, 2) + pow(sz, 2))))/(pow(sx, 2) + pow(sy, 2) + pow(sz, 2)));
}