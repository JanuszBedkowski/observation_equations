inline void point_to_point_rodrigues_wc(double &delta_x, double &delta_y, double &delta_z, double px_1, double py_1, double pz_1, double sx_1, double sy_1, double sz_1, double px_2, double py_2, double pz_2, double sx_2, double sy_2, double sz_2, double x_1, double y_1, double z_1, double x_2, double y_2, double z_2)
{delta_x = -px_1 + px_2 - x_1*(pow(sx_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))) + x_2*(pow(sx_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))) - y_1*(sx_1*sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) + y_2*(sx_2*sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) - z_1*(sx_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) + z_2*(sx_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
delta_y = -py_1 + py_2 - x_1*(sx_1*sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) + x_2*(sx_2*sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) - y_1*(pow(sy_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))) + y_2*(pow(sy_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))) - z_1*(-sx_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) + z_2*(-sx_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
delta_z = -pz_1 + pz_2 - x_1*(sx_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) + x_2*(sx_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) - y_1*(sx_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) + y_2*(sx_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) - z_1*(pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))) + z_2*(pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))));
}
inline void point_to_point_rodrigues_wc_jacobian(Eigen::Matrix<double, 3, 12, Eigen::RowMajor> &j, double px_1, double py_1, double pz_1, double sx_1, double sy_1, double sz_1, double px_2, double py_2, double pz_2, double sx_2, double sy_2, double sz_2, double x_1, double y_1, double z_1, double x_2, double y_2, double z_2)
{j.coeffRef(0,0) = -1;
j.coeffRef(0,1) = 0;
j.coeffRef(0,2) = 0;
j.coeffRef(0,3) = -x_1*(-2*pow(sx_1, 3)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 3)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + 2*sx_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sx_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(-2*pow(sx_1, 2)*sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 2)*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sx_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sx_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-2*pow(sx_1, 2)*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 2)*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sx_1*sy_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sx_1*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(0,4) = -x_1*(-2*pow(sx_1, 2)*sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 2)*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(-2*sx_1*pow(sy_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*pow(sy_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sx_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sy_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0)) - z_1*(-2*sx_1*sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + pow(sy_1, 2)*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - pow(sy_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(0,5) = -x_1*(-2*pow(sx_1, 2)*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 2)*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(-2*sx_1*sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - pow(sz_1, 2)*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-2*sx_1*pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sx_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0));
j.coeffRef(0,6) = 1;
j.coeffRef(0,7) = 0;
j.coeffRef(0,8) = 0;
j.coeffRef(0,9) = x_2*(-2*pow(sx_2, 3)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 3)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + 2*sx_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sx_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(-2*pow(sx_2, 2)*sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 2)*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sx_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sx_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-2*pow(sx_2, 2)*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 2)*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sx_2*sy_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sx_2*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(0,10) = x_2*(-2*pow(sx_2, 2)*sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 2)*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(-2*sx_2*pow(sy_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*pow(sy_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sx_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sy_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0)) + z_2*(-2*sx_2*sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + pow(sy_2, 2)*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - pow(sy_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(0,11) = x_2*(-2*pow(sx_2, 2)*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 2)*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(-2*sx_2*sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - pow(sz_2, 2)*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-2*sx_2*pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sx_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0));
j.coeffRef(1,0) = 0;
j.coeffRef(1,1) = -1;
j.coeffRef(1,2) = 0;
j.coeffRef(1,3) = -x_1*(-2*pow(sx_1, 2)*sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 2)*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sx_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sx_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(-2*sx_1*pow(sy_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*pow(sy_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sx_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-pow(sx_1, 2)*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + pow(sx_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - 2*sx_1*sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(1,4) = -x_1*(-2*sx_1*pow(sy_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*pow(sy_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sx_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0)) - y_1*(-2*pow(sy_1, 3)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sy_1, 3)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + 2*sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-sx_1*sy_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sx_1*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - 2*pow(sy_1, 2)*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sy_1, 2)*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(1,5) = -x_1*(-2*sx_1*sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + pow(sz_1, 2)*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(-2*pow(sy_1, 2)*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sy_1, 2)*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-sx_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sx_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - 2*sy_1*pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sy_1*pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(1,6) = 0;
j.coeffRef(1,7) = 1;
j.coeffRef(1,8) = 0;
j.coeffRef(1,9) = x_2*(-2*pow(sx_2, 2)*sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 2)*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sx_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sx_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(-2*sx_2*pow(sy_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*pow(sy_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sx_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-pow(sx_2, 2)*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + pow(sx_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - 2*sx_2*sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(1,10) = x_2*(-2*sx_2*pow(sy_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*pow(sy_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sx_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0)) + y_2*(-2*pow(sy_2, 3)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sy_2, 3)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + 2*sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-sx_2*sy_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sx_2*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - 2*pow(sy_2, 2)*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sy_2, 2)*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(1,11) = x_2*(-2*sx_2*sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + pow(sz_2, 2)*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(-2*pow(sy_2, 2)*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sy_2, 2)*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-sx_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sx_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - 2*sy_2*pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sy_2*pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(2,0) = 0;
j.coeffRef(2,1) = 0;
j.coeffRef(2,2) = -1;
j.coeffRef(2,3) = -x_1*(-2*pow(sx_1, 2)*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sx_1, 2)*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sx_1*sy_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sx_1*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(pow(sx_1, 2)*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - pow(sx_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - 2*sx_1*sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-2*sx_1*pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sx_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(2,4) = -x_1*(-2*sx_1*sy_1*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - pow(sy_1, 2)*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + pow(sy_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - y_1*(sx_1*sy_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sx_1*sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - 2*pow(sy_1, 2)*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sy_1, 2)*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-2*sy_1*pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sy_1*pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - sy_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(2,5) = -x_1*(-2*sx_1*pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sx_1*pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sx_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sy_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) + sy_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0)) - y_1*(sx_1*sz_1*cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sx_1*sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) - 2*sy_1*pow(sz_1, 2)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + sy_1*pow(sz_1, 2)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + sy_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))) - z_1*(-2*pow(sz_1, 3)*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 2) + pow(sz_1, 3)*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/pow(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2), 3.0/2.0) + 2*sz_1*(1.0 - cos(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2))))/(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)) - sz_1*sin(sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)))/sqrt(pow(sx_1, 2) + pow(sy_1, 2) + pow(sz_1, 2)));
j.coeffRef(2,6) = 0;
j.coeffRef(2,7) = 0;
j.coeffRef(2,8) = 1;
j.coeffRef(2,9) = x_2*(-2*pow(sx_2, 2)*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sx_2, 2)*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sx_2*sy_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sx_2*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(pow(sx_2, 2)*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - pow(sx_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - 2*sx_2*sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-2*sx_2*pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sx_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(2,10) = x_2*(-2*sx_2*sy_2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - pow(sy_2, 2)*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + pow(sy_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + y_2*(sx_2*sy_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sx_2*sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - 2*pow(sy_2, 2)*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sy_2, 2)*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-2*sy_2*pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sy_2*pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - sy_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
j.coeffRef(2,11) = x_2*(-2*sx_2*pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sx_2*pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sx_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sy_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) + sy_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0)) + y_2*(sx_2*sz_2*cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sx_2*sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) - 2*sy_2*pow(sz_2, 2)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + sy_2*pow(sz_2, 2)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + sy_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))) + z_2*(-2*pow(sz_2, 3)*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 2) + pow(sz_2, 3)*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/pow(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2), 3.0/2.0) + 2*sz_2*(1.0 - cos(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2))))/(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)) - sz_2*sin(sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)))/sqrt(pow(sx_2, 2) + pow(sy_2, 2) + pow(sz_2, 2)));
}