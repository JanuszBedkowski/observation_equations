inline void observation_equation_perspective_camera_with_intrinsics_tait_bryan_cw(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp, double k1, double k2, double k3, double p1, double p2)
{delta.coeffRef(0,0) = -cx - fx*(2.0*p1*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(3.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))) + u_kp;
delta.coeffRef(1,0) = -cy - fy*(p1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))) + v_kp;
}inline void projection_perspective_camera_with_intrinsics_tait_bryan_cw(double &u, double &v, double fx, double fy, double cx, double cy, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double k1, double k2, double k3, double p1, double p2)
{u = cx + fx*(2.0*p1*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(3.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
v = cy + fy*(p1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
}
inline void observation_equation_perspective_camera_with_intrinsics_tait_bryan_cw_jacobian(Eigen::Matrix<double, 2, 14> &j, double fx, double fy, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double k1, double k2, double k3, double p1, double p2)
{j.coeffRef(0,0) = -1.0*fx*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om));
j.coeffRef(0,1) = -1.0*fx*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om));
j.coeffRef(0,2) = -1.0*fx*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3)*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om));
j.coeffRef(0,3) = -2.0*fx*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2);
j.coeffRef(0,4) = -fx*(3.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,5) = -fx*(2.0*p1*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(6.0*px + 6.0*tie_px*cos(fi)*cos(ka) - 6.0*tie_py*sin(ka)*cos(fi) + 6.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2*k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3*k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(0,6) = -fx*(2.0*p1*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2*k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3*k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(0,7) = -fx*(-4.0*p1*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + p2*(-6.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(k1*(-2.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + k2*(-4.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 4.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3))*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*(-6.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3))*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,8) = -fx*(2.0*p1*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*p1*(tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(3.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(k1*(1.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(-tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*sin(om)*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,9) = -fx*(2.0*p1*(-tie_px*sin(fi)*cos(ka) + tie_py*sin(fi)*sin(ka) + tie_pz*cos(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(tie_px*sin(om)*cos(fi)*cos(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(fi)*sin(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + p2*(3.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(k1*(1.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(-tie_px*sin(fi)*cos(ka) + tie_py*sin(fi)*sin(ka) + tie_pz*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(tie_px*cos(fi)*cos(ka)*cos(om) - tie_py*sin(ka)*cos(fi)*cos(om) + tie_pz*sin(fi)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,10) = -fx*(2.0*p1*(tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*p1*(-tie_px*sin(ka)*cos(fi) - tie_py*cos(fi)*cos(ka))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(1.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(-tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-tie_px*sin(ka)*cos(fi) - tie_py*cos(fi)*cos(ka))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(0,11) = -fx*(2.0*p1*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*p1*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(1.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 4.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*cos(fi)*cos(ka)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(0,12) = -fx*(2.0*p1*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*p1*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(1.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 4.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*sin(ka)*cos(fi)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(0,13) = -fx*(-4.0*p1*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*p1*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + p2*(-6.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 2.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(k1*(-2.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 2.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(-4.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 4.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 4.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 4.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(-6.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 6.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*sin(fi)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,0) = -1.0*fy*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om));
j.coeffRef(1,1) = -1.0*fy*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om));
j.coeffRef(1,2) = -1.0*fy*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3)*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om));
j.coeffRef(1,3) = -fy*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,4) = -2.0*fy*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2);
j.coeffRef(1,5) = -fy*(p1*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2*k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3*k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(2.0*px + 2.0*tie_px*cos(fi)*cos(ka) - 2.0*tie_py*sin(ka)*cos(fi) + 2.0*tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,6) = -fy*(p1*(6.0*py + 6.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 6.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 6.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2*k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3*k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(2.0*py + 2.0*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,7) = -fy*(p1*(-2.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) - 4.0*p2*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(k1*(-2.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + k2*(-4.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 4.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3))*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*(-6.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3))*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,8) = -fy*(p1*(1.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*p2*(tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*sin(om)*cos(fi))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(-tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*sin(om)*cos(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,9) = -fy*(p1*(1.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + 2.0*p2*(-tie_px*sin(fi)*cos(ka) + tie_py*sin(fi)*sin(ka) + tie_pz*cos(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(tie_px*sin(om)*cos(fi)*cos(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(fi)*sin(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(k1*(1.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*tie_px*cos(fi)*cos(ka)*cos(om) - 2*tie_py*sin(ka)*cos(fi)*cos(om) + 2*tie_pz*sin(fi)*cos(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(tie_px*sin(om)*cos(fi)*cos(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(fi)*sin(om))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(tie_px*cos(fi)*cos(ka)*cos(om) - tie_py*sin(ka)*cos(fi)*cos(om) + tie_pz*sin(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,10) = -fy*(p1*(3.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*p2*(-tie_px*sin(ka)*cos(fi) - tie_py*cos(fi)*cos(ka))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(-tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,11) = -fy*(p1*(3.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*p2*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 4.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,12) = -fy*(p1*(3.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*p2*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + 1.0*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 4.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,13) = -fy*(p1*(-2.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 6.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) - 4.0*p2*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*p2*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(-2.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 2.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 2.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))*(-4.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 4.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 4.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 4.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)*(-6.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) + 6.0*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 6.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 3) - 6.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*cos(fi)*cos(om)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) - 1.0*(k1*(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*sin(om)*cos(fi)/(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)));
}