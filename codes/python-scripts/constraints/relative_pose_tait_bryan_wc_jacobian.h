inline void relative_pose_obs_eq_tait_bryan_wc_case1(Eigen::Matrix<double, 6, 1> &delta, double tx_1, double ty_1, double tz_1, double om_1, double fi_1, double ka_1, double tx_2, double ty_2, double tz_2, double om_2, double fi_2, double ka_2, double tx_m, double ty_m, double tz_m, double om_m, double fi_m, double ka_m)
{delta.coeffRef(0,0) = tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1));
delta.coeffRef(1,0) = -tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1));
delta.coeffRef(2,0) = tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m;
delta.coeffRef(3,0) = om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2));
delta.coeffRef(4,0) = fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1));
delta.coeffRef(5,0) = ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2));
}
inline void relative_pose_obs_eq_tait_bryan_wc_case1_jacobian(Eigen::Matrix<double, 6, 12, Eigen::RowMajor> &j, double tx_1, double ty_1, double tz_1, double om_1, double fi_1, double ka_1, double tx_2, double ty_2, double tz_2, double om_2, double fi_2, double ka_2)
{j.coeffRef(0,0) = cos(fi_1)*cos(ka_1);
j.coeffRef(0,1) = sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1);
j.coeffRef(0,2) = -sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1);
j.coeffRef(0,3) = -ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1));
j.coeffRef(0,4) = -tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(0,5) = -tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1));
j.coeffRef(0,6) = -cos(fi_1)*cos(ka_1);
j.coeffRef(0,7) = -sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1);
j.coeffRef(0,8) = sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1);
j.coeffRef(0,9) = 0;
j.coeffRef(0,10) = 0;
j.coeffRef(0,11) = 0;
j.coeffRef(1,0) = -sin(ka_1)*cos(fi_1);
j.coeffRef(1,1) = -sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1);
j.coeffRef(1,2) = sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1);
j.coeffRef(1,3) = -ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1));
j.coeffRef(1,4) = tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1);
j.coeffRef(1,5) = -tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1));
j.coeffRef(1,6) = sin(ka_1)*cos(fi_1);
j.coeffRef(1,7) = sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1);
j.coeffRef(1,8) = -sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1);
j.coeffRef(1,9) = 0;
j.coeffRef(1,10) = 0;
j.coeffRef(1,11) = 0;
j.coeffRef(2,0) = sin(fi_1);
j.coeffRef(2,1) = -sin(om_1)*cos(fi_1);
j.coeffRef(2,2) = cos(fi_1)*cos(om_1);
j.coeffRef(2,3) = -ty_1*cos(fi_1)*cos(om_1) + ty_2*cos(fi_1)*cos(om_1) - tz_1*sin(om_1)*cos(fi_1) + tz_2*sin(om_1)*cos(fi_1);
j.coeffRef(2,4) = tx_1*cos(fi_1) - tx_2*cos(fi_1) + ty_1*sin(fi_1)*sin(om_1) - ty_2*sin(fi_1)*sin(om_1) - tz_1*sin(fi_1)*cos(om_1) + tz_2*sin(fi_1)*cos(om_1);
j.coeffRef(2,5) = 0;
j.coeffRef(2,6) = -sin(fi_1);
j.coeffRef(2,7) = sin(om_1)*cos(fi_1);
j.coeffRef(2,8) = -cos(fi_1)*cos(om_1);
j.coeffRef(2,9) = 0;
j.coeffRef(2,10) = 0;
j.coeffRef(2,11) = 0;
j.coeffRef(3,0) = 0;
j.coeffRef(3,1) = 0;
j.coeffRef(3,2) = 0;
j.coeffRef(3,3) = -((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,4) = -(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,5) = -(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,6) = 0;
j.coeffRef(3,7) = 0;
j.coeffRef(3,8) = 0;
j.coeffRef(3,9) = -((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,10) = -(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,11) = 0;
j.coeffRef(4,0) = 0;
j.coeffRef(4,1) = 0;
j.coeffRef(4,2) = 0;
j.coeffRef(4,3) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,4) = -(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,5) = -((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,6) = 0;
j.coeffRef(4,7) = 0;
j.coeffRef(4,8) = 0;
j.coeffRef(4,9) = -((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,10) = -(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,11) = 0;
j.coeffRef(5,0) = 0;
j.coeffRef(5,1) = 0;
j.coeffRef(5,2) = 0;
j.coeffRef(5,3) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,4) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,5) = -((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,6) = 0;
j.coeffRef(5,7) = 0;
j.coeffRef(5,8) = 0;
j.coeffRef(5,9) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,10) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,11) = -pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
}inline void relative_pose_tait_bryan_wc_case1(Eigen::Matrix<double, 6, 1> &relative_pose, double tx_1, double ty_1, double tz_1, double om_1, double fi_1, double ka_1, double tx_2, double ty_2, double tz_2, double om_2, double fi_2, double ka_2)
{relative_pose.coeffRef(0,0) = -tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) + ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) + tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1));
relative_pose.coeffRef(1,0) = tx_1*sin(ka_1)*cos(fi_1) - tx_2*sin(ka_1)*cos(fi_1) + ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1));
relative_pose.coeffRef(2,0) = -tx_1*sin(fi_1) + tx_2*sin(fi_1) + ty_1*sin(om_1)*cos(fi_1) - ty_2*sin(om_1)*cos(fi_1) - tz_1*cos(fi_1)*cos(om_1) + tz_2*cos(fi_1)*cos(om_1);
relative_pose.coeffRef(3,0) = atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2));
relative_pose.coeffRef(4,0) = asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1));
relative_pose.coeffRef(5,0) = atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2));
}
inline void relative_pose_obs_eq_tait_bryan_wc_case1_d2sum_dbeta2(Eigen::Matrix<double, 12, 12, Eigen::RowMajor> &j, double tx_1, double ty_1, double tz_1, double om_1, double fi_1, double ka_1, double tx_2, double ty_2, double tz_2, double om_2, double fi_2, double ka_2, double tx_m, double ty_m, double tz_m, double om_m, double fi_m, double ka_m)
{j.coeffRef(0,0) = 2*pow(sin(fi_1), 2) + 2*pow(sin(ka_1), 2)*pow(cos(fi_1), 2) + 2*pow(cos(fi_1), 2)*pow(cos(ka_1), 2);
j.coeffRef(0,1) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(0,2) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(0,3) = (2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*sin(ka_1)*cos(fi_1) + (-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*cos(fi_1)*cos(ka_1) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*sin(fi_1);
j.coeffRef(0,4) = (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*sin(fi_1) + (-2*tx_1*sin(fi_1)*sin(ka_1) + 2*tx_2*sin(fi_1)*sin(ka_1) + 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) - 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) - 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) + 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + (2*tx_1*sin(fi_1) - 2*tx_2*sin(fi_1) - 2*ty_1*sin(om_1)*cos(fi_1) + 2*ty_2*sin(om_1)*cos(fi_1) + 2*tz_1*cos(fi_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(om_1) + 2*tz_m)*cos(fi_1) - (2*tx_1*sin(ka_1)*cos(fi_1) - 2*tx_2*sin(ka_1)*cos(fi_1) + 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*ty_m + 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(fi_1)*sin(ka_1) - (2*tx_1*cos(fi_1)*cos(ka_1) - 2*tx_2*cos(fi_1)*cos(ka_1) + 2*tx_m - 2*ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(fi_1)*cos(ka_1);
j.coeffRef(0,5) = (-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) + (2*tx_1*cos(fi_1)*cos(ka_1) - 2*tx_2*cos(fi_1)*cos(ka_1) + 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) + 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1) + (2*tx_1*sin(ka_1)*cos(fi_1) - 2*tx_2*sin(ka_1)*cos(fi_1) + 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*ty_m + 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) - (2*tx_1*cos(fi_1)*cos(ka_1) - 2*tx_2*cos(fi_1)*cos(ka_1) + 2*tx_m - 2*ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1);
j.coeffRef(0,6) = -2*pow(sin(fi_1), 2) - 2*pow(sin(ka_1), 2)*pow(cos(fi_1), 2) - 2*pow(cos(fi_1), 2)*pow(cos(ka_1), 2);
j.coeffRef(0,7) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(0,8) = (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(0,9) = 0;
j.coeffRef(0,10) = 0;
j.coeffRef(0,11) = 0;
j.coeffRef(1,0) = -(-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(1,1) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1)) + 2*pow(sin(om_1), 2)*pow(cos(fi_1), 2);
j.coeffRef(1,2) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(1,3) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (2*ty_1*cos(fi_1)*cos(om_1) - 2*ty_2*cos(fi_1)*cos(om_1) + 2*tz_1*sin(om_1)*cos(fi_1) - 2*tz_2*sin(om_1)*cos(fi_1))*sin(om_1)*cos(fi_1) + (-2*tx_1*sin(fi_1) + 2*tx_2*sin(fi_1) + 2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1) - 2*tz_m)*cos(fi_1)*cos(om_1);
j.coeffRef(1,4) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (-2*tx_1*cos(fi_1) + 2*tx_2*cos(fi_1) - 2*ty_1*sin(fi_1)*sin(om_1) + 2*ty_2*sin(fi_1)*sin(om_1) + 2*tz_1*sin(fi_1)*cos(om_1) - 2*tz_2*sin(fi_1)*cos(om_1))*sin(om_1)*cos(fi_1) - (-2*tx_1*sin(fi_1) + 2*tx_2*sin(fi_1) + 2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1) - 2*tz_m)*sin(fi_1)*sin(om_1) - 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(om_1)*cos(fi_1)*cos(ka_1);
j.coeffRef(1,5) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(1,6) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) - (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(1,7) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1)) - 2*pow(sin(om_1), 2)*pow(cos(fi_1), 2);
j.coeffRef(1,8) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) + 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(1,9) = 0;
j.coeffRef(1,10) = 0;
j.coeffRef(1,11) = 0;
j.coeffRef(2,0) = -(2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(2,1) = (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1)) - 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(2,2) = (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1)) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) + 2*pow(cos(fi_1), 2)*pow(cos(om_1), 2);
j.coeffRef(2,3) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*cos(fi_1)*cos(om_1) - (2*tx_1*sin(fi_1) - 2*tx_2*sin(fi_1) - 2*ty_1*sin(om_1)*cos(fi_1) + 2*ty_2*sin(om_1)*cos(fi_1) + 2*tz_1*cos(fi_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(om_1) + 2*tz_m)*sin(om_1)*cos(fi_1);
j.coeffRef(2,4) = (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*cos(fi_1)*cos(om_1) - (2*tx_1*sin(fi_1) - 2*tx_2*sin(fi_1) - 2*ty_1*sin(om_1)*cos(fi_1) + 2*ty_2*sin(om_1)*cos(fi_1) + 2*tz_1*cos(fi_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(om_1) + 2*tz_m)*sin(fi_1)*cos(om_1) + 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(2,5) = (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(2,6) = (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) - (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(2,7) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1)) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1)) + 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(2,8) = (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1)) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*pow(cos(fi_1), 2)*pow(cos(om_1), 2);
j.coeffRef(2,9) = 0;
j.coeffRef(2,10) = 0;
j.coeffRef(2,11) = 0;
j.coeffRef(3,0) = -(-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*sin(ka_1)*cos(fi_1) + (-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*cos(fi_1)*cos(ka_1) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*sin(fi_1);
j.coeffRef(3,1) = (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) - (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*sin(om_1)*cos(fi_1) - 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*cos(fi_1)*cos(om_1);
j.coeffRef(3,2) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*cos(fi_1)*cos(om_1) - 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*sin(om_1)*cos(fi_1);
j.coeffRef(3,3) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*ty_1*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*ty_2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (-2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*(-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1))*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*(-ty_1*cos(fi_1)*cos(om_1) + ty_2*cos(fi_1)*cos(om_1) - tz_1*sin(om_1)*cos(fi_1) + tz_2*sin(om_1)*cos(fi_1)) + 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2), 2)/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(3,4) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*sin(om_1)*cos(fi_2)*cos(om_2) - sin(fi_1)*sin(om_2)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2)*sin(ka_1) + sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(ka_1)*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(ka_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*(-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*ty_1*sin(fi_1)*cos(om_1) - 2*ty_2*sin(fi_1)*cos(om_1) + 2*tz_1*sin(fi_1)*sin(om_1) - 2*tz_2*sin(fi_1)*sin(om_1))*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*(tx_1*cos(fi_1) - tx_2*cos(fi_1) + ty_1*sin(fi_1)*sin(om_1) - ty_2*sin(fi_1)*sin(om_1) - tz_1*sin(fi_1)*cos(om_1) + tz_2*sin(fi_1)*cos(om_1)) + (-2*ty_1*sin(ka_1)*cos(fi_1)*cos(om_1) + 2*ty_2*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_2*sin(ka_1)*sin(om_1)*cos(fi_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*ty_1*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*ty_2*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_2*sin(om_1)*cos(fi_1)*cos(ka_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-2*sin(fi_1)*sin(fi_2)*cos(ka_1) - 2*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(3,5) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2)) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - (-2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*ty_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*ty_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(3,6) = (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*sin(ka_1)*cos(fi_1) - (-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*cos(fi_1)*cos(ka_1) - (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*sin(fi_1);
j.coeffRef(3,7) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*sin(om_1)*cos(fi_1) + 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*cos(fi_1)*cos(om_1);
j.coeffRef(3,8) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) - (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*cos(fi_1)*cos(om_1) + 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*sin(om_1)*cos(fi_1);
j.coeffRef(3,9) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(3,10) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*sin(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_2)*sin(om_1)*cos(fi_1)*cos(om_2) - sin(fi_2)*sin(om_2)*cos(fi_1)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) - sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*sin(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(3,11) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(4,0) = (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*sin(fi_1) - (2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*cos(fi_1) + 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(fi_1)*sin(ka_1) - 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(fi_1)*cos(ka_1);
j.coeffRef(4,1) = (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) - (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*sin(om_1)*cos(fi_1) + 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*sin(fi_1)*sin(om_1) - 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(om_1)*cos(fi_1)*cos(ka_1);
j.coeffRef(4,2) = (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*cos(fi_1)*cos(om_1) - 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*sin(fi_1)*cos(om_1) + 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(4,3) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*sin(om_1)*cos(fi_2)*cos(om_2) - sin(fi_1)*sin(om_2)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(ka_1)*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(ka_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*(-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*ty_1*sin(fi_1)*cos(om_1) - 2*ty_2*sin(fi_1)*cos(om_1) + 2*tz_1*sin(fi_1)*sin(om_1) - 2*tz_2*sin(fi_1)*sin(om_1))*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m) + (-ty_1*cos(fi_1)*cos(om_1) + ty_2*cos(fi_1)*cos(om_1) - tz_1*sin(om_1)*cos(fi_1) + tz_2*sin(om_1)*cos(fi_1))*(2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1)) + (-2*ty_1*sin(ka_1)*cos(fi_1)*cos(om_1) + 2*ty_2*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_2*sin(ka_1)*sin(om_1)*cos(fi_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*ty_1*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*ty_2*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_2*sin(om_1)*cos(fi_1)*cos(ka_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(4,4) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(fi_1)*sin(om_1)*cos(ka_1) - (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*sin(fi_1)*cos(ka_1)*cos(om_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(-(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(fi_1)*sin(om_1)*cos(ka_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-sin(fi_1)*sin(fi_2) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(sin(fi_1)*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_2) + sin(fi_1)*sin(ka_1)*cos(fi_2)*cos(om_1)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*sin(fi_2)*sin(ka_1) + sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*tx_1*sin(fi_1) + 2*tx_2*sin(fi_1) + 2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1))*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m) + (tx_1*cos(fi_1) - tx_2*cos(fi_1) + ty_1*sin(fi_1)*sin(om_1) - ty_2*sin(fi_1)*sin(om_1) - tz_1*sin(fi_1)*cos(om_1) + tz_2*sin(fi_1)*cos(om_1))*(2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1)) + (tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*(2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*(-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*tx_1*sin(ka_1)*cos(fi_1) - 2*tx_2*sin(ka_1)*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*tz_1*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*tz_2*sin(fi_1)*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*ty_2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*tz_1*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*tz_2*sin(fi_1)*cos(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + 2*pow(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2), 2)/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2)*cos(ka_1) + sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-2*sin(fi_1)*sin(fi_2)*cos(ka_1) - 2*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(4,5) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(ka_1)*sin(om_1)*cos(fi_1) - (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*sin(ka_1)*cos(fi_1)*cos(om_1) + sin(fi_1)*sin(ka_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(-(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(ka_1)*sin(om_1)*cos(fi_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*sin(ka_1)*cos(fi_1)*cos(om_1) + sin(fi_1)*sin(ka_1)*sin(ka_2)*cos(fi_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) + 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2)) + (-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - (-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*tx_1*sin(fi_1)*cos(ka_1) - 2*tx_2*sin(fi_1)*cos(ka_1) - 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) + 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) + 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(sin(fi_1)*sin(fi_2)*sin(ka_1) + sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(4,6) = -(2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*sin(fi_1) + (2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*sin(ka_1)*cos(fi_1) - (-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) - 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*cos(fi_1) - 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(fi_1)*sin(ka_1) + 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(fi_1)*cos(ka_1);
j.coeffRef(4,7) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*sin(om_1)*cos(fi_1) - 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*sin(fi_1)*sin(om_1) + 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*sin(om_1)*cos(fi_1) - 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(om_1)*cos(fi_1)*cos(ka_1);
j.coeffRef(4,8) = (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) - (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*cos(fi_1)*cos(om_1) + 2*(tx_1*sin(fi_1) - tx_2*sin(fi_1) - ty_1*sin(om_1)*cos(fi_1) + ty_2*sin(om_1)*cos(fi_1) + tz_1*cos(fi_1)*cos(om_1) - tz_2*cos(fi_1)*cos(om_1) + tz_m)*sin(fi_1)*cos(om_1) - 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*cos(fi_1)*cos(om_1) + 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(4,9) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(fi_1)*sin(om_1)*cos(fi_2)*cos(om_2) + sin(fi_1)*sin(om_2)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(ka_1)*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(ka_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(4,10) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(sin(fi_1)*sin(fi_2)*cos(ka_1)*cos(ka_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)*cos(om_1)*cos(om_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(sin(fi_1)*sin(fi_2)*sin(ka_2)*cos(ka_1) + sin(ka_2)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(ka_1)*cos(fi_2) + sin(fi_2)*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1) + sin(fi_2)*sin(ka_1)*cos(fi_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(sin(fi_1)*sin(fi_2)*sin(om_1)*sin(om_2) + sin(fi_1)*sin(fi_2)*cos(om_1)*cos(om_2) + cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) - sin(ka_1)*cos(fi_1)*cos(fi_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-sin(fi_1)*cos(fi_2)*cos(ka_1) + sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(ka_1) + sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(4,11) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) + (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) + (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(5,0) = (-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) - (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1) - 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) - 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1);
j.coeffRef(5,1) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(5,2) = (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(5,3) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(-((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*(-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*ty_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*ty_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(5,4) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(ka_1)*sin(om_1)*cos(fi_1) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*sin(ka_1)*cos(fi_1)*cos(om_1) + sin(fi_1)*sin(ka_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(-(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(ka_1)*sin(om_1)*cos(fi_1) + (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*sin(ka_1)*cos(fi_1)*cos(om_1) + sin(fi_1)*sin(ka_1)*sin(ka_2)*cos(fi_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*(-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*tx_1*sin(fi_1)*cos(ka_1) - 2*tx_2*sin(fi_1)*cos(ka_1) - 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) + 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) + 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(sin(fi_1)*sin(fi_2)*sin(ka_1) + sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-2*sin(fi_1)*sin(fi_2)*cos(ka_1) - 2*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(5,5) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*tx_1*sin(ka_1)*cos(fi_1) - 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*ty_2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + 2*pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2)*pow((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) + 2*pow((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1), 2)/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(5,6) = -(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) + (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1) + 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) + 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1);
j.coeffRef(5,7) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(5,8) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(5,9) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(5,10) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(ka_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*sin(ka_2)*cos(fi_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) - sin(ka_1)*cos(fi_1)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(5,11) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(6,0) = -2*pow(sin(fi_1), 2) - 2*pow(sin(ka_1), 2)*pow(cos(fi_1), 2) - 2*pow(cos(fi_1), 2)*pow(cos(ka_1), 2);
j.coeffRef(6,1) = (-2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(6,2) = (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(6,3) = (-2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)))*sin(ka_1)*cos(fi_1) + (2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) + 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) + 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)))*cos(fi_1)*cos(ka_1) + (2*ty_1*cos(fi_1)*cos(om_1) - 2*ty_2*cos(fi_1)*cos(om_1) + 2*tz_1*sin(om_1)*cos(fi_1) - 2*tz_2*sin(om_1)*cos(fi_1))*sin(fi_1);
j.coeffRef(6,4) = (-2*tx_1*cos(fi_1) + 2*tx_2*cos(fi_1) - 2*ty_1*sin(fi_1)*sin(om_1) + 2*ty_2*sin(fi_1)*sin(om_1) + 2*tz_1*sin(fi_1)*cos(om_1) - 2*tz_2*sin(fi_1)*cos(om_1))*sin(fi_1) + (2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (2*tx_1*sin(fi_1)*cos(ka_1) - 2*tx_2*sin(fi_1)*cos(ka_1) - 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) + 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) + 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + (-2*tx_1*sin(fi_1) + 2*tx_2*sin(fi_1) + 2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1) - 2*tz_m)*cos(fi_1) - (-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + 2*ty_m - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(fi_1)*sin(ka_1) - (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*tx_m + 2*ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + 2*ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + 2*tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) + 2*tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(fi_1)*cos(ka_1);
j.coeffRef(6,5) = (2*tx_1*sin(ka_1)*cos(fi_1) - 2*tx_2*sin(ka_1)*cos(fi_1) + 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) + (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1) + (-2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + 2*ty_m - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*cos(fi_1)*cos(ka_1) - (-2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*tx_m + 2*ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + 2*ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + 2*tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) + 2*tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(ka_1)*cos(fi_1);
j.coeffRef(6,6) = 2*pow(sin(fi_1), 2) + 2*pow(sin(ka_1), 2)*pow(cos(fi_1), 2) + 2*pow(cos(fi_1), 2)*pow(cos(ka_1), 2);
j.coeffRef(6,7) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(6,8) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(6,9) = 0;
j.coeffRef(6,10) = 0;
j.coeffRef(6,11) = 0;
j.coeffRef(7,0) = -(2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(7,1) = (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1)) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*pow(sin(om_1), 2)*pow(cos(fi_1), 2);
j.coeffRef(7,2) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) + 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(7,3) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1))*sin(om_1)*cos(fi_1) + (2*tx_1*sin(fi_1) - 2*tx_2*sin(fi_1) - 2*ty_1*sin(om_1)*cos(fi_1) + 2*ty_2*sin(om_1)*cos(fi_1) + 2*tz_1*cos(fi_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(om_1) + 2*tz_m)*cos(fi_1)*cos(om_1);
j.coeffRef(7,4) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1))*sin(om_1)*cos(fi_1) - (2*tx_1*sin(fi_1) - 2*tx_2*sin(fi_1) - 2*ty_1*sin(om_1)*cos(fi_1) + 2*ty_2*sin(om_1)*cos(fi_1) + 2*tz_1*cos(fi_1)*cos(om_1) - 2*tz_2*cos(fi_1)*cos(om_1) + 2*tz_m)*sin(fi_1)*sin(om_1) + 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*sin(om_1)*cos(fi_1) - 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(om_1)*cos(fi_1)*cos(ka_1);
j.coeffRef(7,5) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(7,6) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*sin(ka_1)*cos(fi_1) - (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*sin(om_1)*cos(fi_1);
j.coeffRef(7,7) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1)) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + 2*pow(sin(om_1), 2)*pow(cos(fi_1), 2);
j.coeffRef(7,8) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(7,9) = 0;
j.coeffRef(7,10) = 0;
j.coeffRef(7,11) = 0;
j.coeffRef(8,0) = -(-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) - 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(8,1) = (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1)) + 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(8,2) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1)) - 2*pow(cos(fi_1), 2)*pow(cos(om_1), 2);
j.coeffRef(8,3) = (2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(-ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))) + (-2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(-ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))) + (2*ty_1*cos(fi_1)*cos(om_1) - 2*ty_2*cos(fi_1)*cos(om_1) + 2*tz_1*sin(om_1)*cos(fi_1) - 2*tz_2*sin(om_1)*cos(fi_1))*cos(fi_1)*cos(om_1) - (-2*tx_1*sin(fi_1) + 2*tx_2*sin(fi_1) + 2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1) - 2*tz_m)*sin(om_1)*cos(fi_1);
j.coeffRef(8,4) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(tx_1*sin(fi_1)*sin(ka_1) - tx_2*sin(fi_1)*sin(ka_1) - ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - tz_2*sin(ka_1)*cos(fi_1)*cos(om_1)) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(fi_1)*cos(ka_1) + tx_2*sin(fi_1)*cos(ka_1) + ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + tz_2*cos(fi_1)*cos(ka_1)*cos(om_1)) + (-2*tx_1*cos(fi_1) + 2*tx_2*cos(fi_1) - 2*ty_1*sin(fi_1)*sin(om_1) + 2*ty_2*sin(fi_1)*sin(om_1) + 2*tz_1*sin(fi_1)*cos(om_1) - 2*tz_2*sin(fi_1)*cos(om_1))*cos(fi_1)*cos(om_1) - (-2*tx_1*sin(fi_1) + 2*tx_2*sin(fi_1) + 2*ty_1*sin(om_1)*cos(fi_1) - 2*ty_2*sin(om_1)*cos(fi_1) - 2*tz_1*cos(fi_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(om_1) - 2*tz_m)*sin(fi_1)*cos(om_1) - 2*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)))*sin(ka_1)*cos(fi_1)*cos(om_1) + 2*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(8,5) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(-tx_1*cos(fi_1)*cos(ka_1) + tx_2*cos(fi_1)*cos(ka_1) - ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(tx_1*cos(fi_1)*cos(ka_1) - tx_2*cos(fi_1)*cos(ka_1) + tx_m - ty_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - ty_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - tz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - tz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + ty_m - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))) + (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*(-tx_1*sin(ka_1)*cos(fi_1) + tx_2*sin(ka_1)*cos(fi_1) - ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)));
j.coeffRef(8,6) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*sin(ka_1)*cos(fi_1) - (2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1))*cos(fi_1)*cos(ka_1) + 2*sin(fi_1)*cos(fi_1)*cos(om_1);
j.coeffRef(8,7) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1)) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1)) - 2*sin(om_1)*pow(cos(fi_1), 2)*cos(om_1);
j.coeffRef(8,8) = (-2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1))*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1)) + 2*pow(cos(fi_1), 2)*pow(cos(om_1), 2);
j.coeffRef(8,9) = 0;
j.coeffRef(8,10) = 0;
j.coeffRef(8,11) = 0;
j.coeffRef(9,0) = 0;
j.coeffRef(9,1) = 0;
j.coeffRef(9,2) = 0;
j.coeffRef(9,3) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(9,4) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(-(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(fi_1)*sin(om_1)*cos(fi_2)*cos(om_2) + sin(fi_1)*sin(om_2)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2)*sin(ka_1) + sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(ka_1)*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(ka_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-2*sin(fi_1)*sin(fi_2)*cos(ka_1) - 2*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(9,5) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2)) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(9,6) = 0;
j.coeffRef(9,7) = 0;
j.coeffRef(9,8) = 0;
j.coeffRef(9,9) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*pow((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2), 2)/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(9,10) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*sin(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(fi_2)*sin(om_1)*cos(fi_1)*cos(om_2) + sin(fi_2)*sin(om_2)*cos(fi_1)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) - sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_2)*sin(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(9,11) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(10,0) = 0;
j.coeffRef(10,1) = 0;
j.coeffRef(10,2) = 0;
j.coeffRef(10,3) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (-2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*sin(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_2)*sin(om_1)*cos(fi_1)*cos(om_2) - sin(fi_2)*sin(om_2)*cos(fi_1)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_2)*sin(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(10,4) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(sin(fi_1)*sin(fi_2)*cos(ka_1)*cos(ka_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)*cos(om_1)*cos(om_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(sin(fi_1)*sin(fi_2)*sin(ka_2)*cos(ka_1) + sin(ka_2)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-2*sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - 2*sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(-2*sin(fi_1)*sin(fi_2)*sin(ka_1) - 2*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(ka_1)*cos(fi_2) + sin(fi_2)*sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1) + sin(fi_2)*sin(ka_1)*cos(fi_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(sin(fi_1)*sin(fi_2)*sin(ka_1) + sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(sin(fi_1)*sin(fi_2)*sin(om_1)*sin(om_2) + sin(fi_1)*sin(fi_2)*cos(om_1)*cos(om_2) + cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-sin(fi_1)*cos(fi_2)*cos(ka_1) + sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(ka_1) + sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))*(-2*sin(fi_1)*sin(fi_2)*cos(ka_1) - 2*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(10,5) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*cos(fi_2)*cos(ka_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*sin(ka_2)*cos(fi_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) + 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2)) + (-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) - (-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) - sin(ka_1)*cos(fi_1)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_1)*cos(fi_1))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(10,6) = 0;
j.coeffRef(10,7) = 0;
j.coeffRef(10,8) = 0;
j.coeffRef(10,9) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)) - (2*sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - 2*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*sin(om_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(fi_2)*sin(om_1)*cos(fi_1)*cos(om_2) + sin(fi_2)*sin(om_2)*cos(fi_1)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_2)*cos(om_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_2)*sin(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(10,10) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2)*cos(ka_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_2)*cos(ka_2)*cos(om_2) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_2)*sin(ka_2)*sin(om_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_2)*sin(ka_2)*cos(om_2) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (om_m - atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)))*(-2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(2*sin(fi_1)*cos(fi_2) - 2*sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - 2*sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2)) - (-2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + 2*sin(ka_1)*cos(fi_1)*cos(fi_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1)))*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/pow(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2), 2) - 2*(-sin(fi_1)*sin(fi_2) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) - sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + (-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)))*(-(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2))) + 2*pow(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - 2*(fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2)) - (fi_m - asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)))*(-2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/pow(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2), 3.0/2.0);
j.coeffRef(10,11) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(11,0) = 0;
j.coeffRef(11,1) = 0;
j.coeffRef(11,2) = 0;
j.coeffRef(11,3) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(11,4) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(11,5) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - 2*sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(11,6) = 0;
j.coeffRef(11,7) = 0;
j.coeffRef(11,8) = 0;
j.coeffRef(11,9) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(11,10) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(-2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) + 2*sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - 2*sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
j.coeffRef(11,11) = (ka_m - atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*(-2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*(-(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) - (2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)))*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/pow(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2), 2) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) - 2*cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*(2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + 2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - 2*sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2))) + (-2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)))*(-pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)));
}inline void relative_pose_obs_eq_tait_bryan_wc_case1_d2sum_dbetadx(Eigen::Matrix<double, 12, 6, Eigen::RowMajor> &j, double tx_1, double ty_1, double tz_1, double om_1, double fi_1, double ka_1, double tx_2, double ty_2, double tz_2, double om_2, double fi_2, double ka_2, double tx_m, double ty_m, double tz_m, double om_m, double fi_m, double ka_m)
{j.coeffRef(0,0) = 2*cos(fi_1)*cos(ka_1);
j.coeffRef(0,1) = -2*sin(ka_1)*cos(fi_1);
j.coeffRef(0,2) = 2*sin(fi_1);
j.coeffRef(0,3) = 0;
j.coeffRef(0,4) = 0;
j.coeffRef(0,5) = 0;
j.coeffRef(1,0) = 2*sin(fi_1)*sin(om_1)*cos(ka_1) + 2*sin(ka_1)*cos(om_1);
j.coeffRef(1,1) = -2*sin(fi_1)*sin(ka_1)*sin(om_1) + 2*cos(ka_1)*cos(om_1);
j.coeffRef(1,2) = -2*sin(om_1)*cos(fi_1);
j.coeffRef(1,3) = 0;
j.coeffRef(1,4) = 0;
j.coeffRef(1,5) = 0;
j.coeffRef(2,0) = -2*sin(fi_1)*cos(ka_1)*cos(om_1) + 2*sin(ka_1)*sin(om_1);
j.coeffRef(2,1) = 2*sin(fi_1)*sin(ka_1)*cos(om_1) + 2*sin(om_1)*cos(ka_1);
j.coeffRef(2,2) = 2*cos(fi_1)*cos(om_1);
j.coeffRef(2,3) = 0;
j.coeffRef(2,4) = 0;
j.coeffRef(2,5) = 0;
j.coeffRef(3,0) = -2*ty_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*ty_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - 2*tz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1));
j.coeffRef(3,1) = -2*ty_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*tz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1));
j.coeffRef(3,2) = -2*ty_1*cos(fi_1)*cos(om_1) + 2*ty_2*cos(fi_1)*cos(om_1) - 2*tz_1*sin(om_1)*cos(fi_1) + 2*tz_2*sin(om_1)*cos(fi_1);
j.coeffRef(3,3) = -2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,4) = -2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(3,5) = -2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(4,0) = -2*tx_1*sin(fi_1)*cos(ka_1) + 2*tx_2*sin(fi_1)*cos(ka_1) + 2*ty_1*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*ty_2*sin(om_1)*cos(fi_1)*cos(ka_1) - 2*tz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + 2*tz_2*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(4,1) = 2*tx_1*sin(fi_1)*sin(ka_1) - 2*tx_2*sin(fi_1)*sin(ka_1) - 2*ty_1*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*ty_2*sin(ka_1)*sin(om_1)*cos(fi_1) + 2*tz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - 2*tz_2*sin(ka_1)*cos(fi_1)*cos(om_1);
j.coeffRef(4,2) = 2*tx_1*cos(fi_1) - 2*tx_2*cos(fi_1) + 2*ty_1*sin(fi_1)*sin(om_1) - 2*ty_2*sin(fi_1)*sin(om_1) - 2*tz_1*sin(fi_1)*cos(om_1) + 2*tz_2*sin(fi_1)*cos(om_1);
j.coeffRef(4,3) = -2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(4,4) = -2*(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,5) = -2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,0) = -2*tx_1*sin(ka_1)*cos(fi_1) + 2*tx_2*sin(ka_1)*cos(fi_1) - 2*ty_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - 2*tz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1));
j.coeffRef(5,1) = -2*tx_1*cos(fi_1)*cos(ka_1) + 2*tx_2*cos(fi_1)*cos(ka_1) - 2*ty_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - 2*ty_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - 2*tz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - 2*tz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1));
j.coeffRef(5,2) = 0;
j.coeffRef(5,3) = -2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(5,4) = -2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(5,5) = -2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(6,0) = -2*cos(fi_1)*cos(ka_1);
j.coeffRef(6,1) = 2*sin(ka_1)*cos(fi_1);
j.coeffRef(6,2) = -2*sin(fi_1);
j.coeffRef(6,3) = 0;
j.coeffRef(6,4) = 0;
j.coeffRef(6,5) = 0;
j.coeffRef(7,0) = -2*sin(fi_1)*sin(om_1)*cos(ka_1) - 2*sin(ka_1)*cos(om_1);
j.coeffRef(7,1) = 2*sin(fi_1)*sin(ka_1)*sin(om_1) - 2*cos(ka_1)*cos(om_1);
j.coeffRef(7,2) = 2*sin(om_1)*cos(fi_1);
j.coeffRef(7,3) = 0;
j.coeffRef(7,4) = 0;
j.coeffRef(7,5) = 0;
j.coeffRef(8,0) = 2*sin(fi_1)*cos(ka_1)*cos(om_1) - 2*sin(ka_1)*sin(om_1);
j.coeffRef(8,1) = -2*sin(fi_1)*sin(ka_1)*cos(om_1) - 2*sin(om_1)*cos(ka_1);
j.coeffRef(8,2) = -2*cos(fi_1)*cos(om_1);
j.coeffRef(8,3) = 0;
j.coeffRef(8,4) = 0;
j.coeffRef(8,5) = 0;
j.coeffRef(9,0) = 0;
j.coeffRef(9,1) = 0;
j.coeffRef(9,2) = 0;
j.coeffRef(9,3) = -2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(9,4) = -2*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(9,5) = -2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(10,0) = 0;
j.coeffRef(10,1) = 0;
j.coeffRef(10,2) = 0;
j.coeffRef(10,3) = -2*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - 2*(sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(10,4) = -2*(-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(10,5) = -2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(11,0) = 0;
j.coeffRef(11,1) = 0;
j.coeffRef(11,2) = 0;
j.coeffRef(11,3) = 0;
j.coeffRef(11,4) = 0;
j.coeffRef(11,5) = -2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - 2*pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
}