inline void relative_pose_2_obs_eq_tait_bryan_wc_case1(Eigen::Matrix<double, 6, 1> &delta, double px_1, double py_1, double pz_1, double om_1, double fi_1, double ka_1, double px_2, double py_2, double pz_2, double om_2, double fi_2, double ka_2, double px_m, double py_m, double pz_m, double om_m, double fi_m, double ka_m)
{delta.coeffRef(0,0) = -px_2*(-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)) + px_m*cos(fi_m)*cos(ka_m) - py_2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - py_m*(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m)) - pz_2*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - pz_m*(sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m)) - (sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*(px_1*sin(ka_1)*cos(fi_1) + py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*(-px_1*sin(fi_1) + py_1*sin(om_1)*cos(fi_1) - pz_1*cos(fi_1)*cos(om_1)) - (-px_1*cos(fi_1)*cos(ka_1) + py_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + pz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*cos(fi_m)*cos(ka_m);
delta.coeffRef(1,0) = -px_2*(-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1)) - px_m*sin(ka_m)*cos(fi_m) - py_2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1)) - py_m*(sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m)) - pz_2*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1)) - pz_m*(-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m)) - (-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*(px_1*sin(ka_1)*cos(fi_1) + py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*(-px_1*sin(fi_1) + py_1*sin(om_1)*cos(fi_1) - pz_1*cos(fi_1)*cos(om_1)) + (-px_1*cos(fi_1)*cos(ka_1) + py_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + pz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*sin(ka_m)*cos(fi_m);
delta.coeffRef(2,0) = -px_2*(sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m)) + px_m*sin(fi_m) - py_2*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m)) - py_m*sin(om_m)*cos(fi_m) - pz_2*(-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m)) + pz_m*cos(fi_m)*cos(om_m) - (-px_1*sin(fi_1) + py_1*sin(om_1)*cos(fi_1) - pz_1*cos(fi_1)*cos(om_1))*cos(fi_m)*cos(om_m) + (px_1*sin(ka_1)*cos(fi_1) + py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)))*sin(om_m)*cos(fi_m) - (-px_1*cos(fi_1)*cos(ka_1) + py_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) + pz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)))*sin(fi_m);
delta.coeffRef(3,0) = -atan2(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), -(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2));
delta.coeffRef(4,0) = -asin(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2));
delta.coeffRef(5,0) = -atan2(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), (sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2));
}
inline void relative_pose_2_obs_eq_tait_bryan_wc_case1_jacobian(Eigen::Matrix<double, 6, 12, Eigen::RowMajor> &j, double px_1, double py_1, double pz_1, double om_1, double fi_1, double ka_1, double px_2, double py_2, double pz_2, double om_2, double fi_2, double ka_2, double px_m, double py_m, double pz_m, double om_m, double fi_m, double ka_m)
{j.coeffRef(0,0) = (-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) - (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m);
j.coeffRef(0,1) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1);
j.coeffRef(0,2) = (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) - (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1);
j.coeffRef(0,3) = -py_2*((-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - pz_2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (py_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + pz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)))*(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m)) + (-py_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - pz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)))*cos(fi_m)*cos(ka_m) + (py_1*cos(fi_1)*cos(om_1) + pz_1*sin(om_1)*cos(fi_1))*(sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m));
j.coeffRef(0,4) = -px_2*(-(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*sin(fi_1)*sin(ka_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1) - sin(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)) - py_2*(-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*sin(om_1)*cos(fi_1) - (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*sin(fi_1)*sin(om_1) + sin(om_1)*cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)) - pz_2*((sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1)*cos(om_1) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1)*cos(om_1) - cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)*cos(om_1)) + (-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*(-px_1*sin(fi_1)*sin(ka_1) + py_1*sin(ka_1)*sin(om_1)*cos(fi_1) - pz_1*sin(ka_1)*cos(fi_1)*cos(om_1)) + (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*(-px_1*cos(fi_1) - py_1*sin(fi_1)*sin(om_1) + pz_1*sin(fi_1)*cos(om_1)) + (-px_1*sin(fi_1)*cos(ka_1) + py_1*sin(om_1)*cos(fi_1)*cos(ka_1) - pz_1*cos(fi_1)*cos(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m);
j.coeffRef(0,5) = -px_2*((-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*cos(fi_1)*cos(ka_1) - sin(ka_1)*cos(fi_1)*cos(fi_m)*cos(ka_m)) - py_2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))) - pz_2*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_m)*cos(ka_m) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))) + (-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*(px_1*cos(fi_1)*cos(ka_1) + py_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (-px_1*sin(ka_1)*cos(fi_1) - py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)))*cos(fi_m)*cos(ka_m);
j.coeffRef(0,6) = (sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) - cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m);
j.coeffRef(0,7) = -(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1);
j.coeffRef(0,8) = -(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1);
j.coeffRef(0,9) = 0;
j.coeffRef(0,10) = 0;
j.coeffRef(0,11) = 0;
j.coeffRef(1,0) = (sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) - (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1);
j.coeffRef(1,1) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m)) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) + (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1);
j.coeffRef(1,2) = (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) - (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1);
j.coeffRef(1,3) = -py_2*((-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1)) - pz_2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1)) + (py_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + pz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)))*(sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m)) + (py_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) + pz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)))*sin(ka_m)*cos(fi_m) + (py_1*cos(fi_1)*cos(om_1) + pz_1*sin(om_1)*cos(fi_1))*(-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m));
j.coeffRef(1,4) = -px_2*(-(sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*sin(fi_1)*sin(ka_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1) + sin(fi_1)*sin(ka_m)*cos(fi_m)*cos(ka_1)) - py_2*(-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*sin(om_1)*cos(fi_1) - (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*sin(fi_1)*sin(om_1) - sin(ka_m)*sin(om_1)*cos(fi_1)*cos(fi_m)*cos(ka_1)) - pz_2*((-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1)*cos(om_1) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1)*cos(om_1) + sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(om_1)) + (sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*(-px_1*sin(fi_1)*sin(ka_1) + py_1*sin(ka_1)*sin(om_1)*cos(fi_1) - pz_1*sin(ka_1)*cos(fi_1)*cos(om_1)) + (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*(-px_1*cos(fi_1) - py_1*sin(fi_1)*sin(om_1) + pz_1*sin(fi_1)*cos(om_1)) + (px_1*sin(fi_1)*cos(ka_1) - py_1*sin(om_1)*cos(fi_1)*cos(ka_1) + pz_1*cos(fi_1)*cos(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m);
j.coeffRef(1,5) = -px_2*((sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(ka_m)*cos(fi_1)*cos(fi_m)) - py_2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))) - pz_2*((-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(ka_m)*cos(fi_m) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))) + (sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*(px_1*cos(fi_1)*cos(ka_1) + py_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))) + (px_1*sin(ka_1)*cos(fi_1) + py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)))*sin(ka_m)*cos(fi_m);
j.coeffRef(1,6) = (-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) + sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1);
j.coeffRef(1,7) = -(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1);
j.coeffRef(1,8) = -(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1);
j.coeffRef(1,9) = 0;
j.coeffRef(1,10) = 0;
j.coeffRef(1,11) = 0;
j.coeffRef(2,0) = sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m);
j.coeffRef(2,1) = (sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m);
j.coeffRef(2,2) = (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m);
j.coeffRef(2,3) = -py_2*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_m) - cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m)) - pz_2*((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m)) + (py_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + pz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)))*sin(om_m)*cos(fi_m) + (-py_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - pz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)))*sin(fi_m) + (-py_1*cos(fi_1)*cos(om_1) - pz_1*sin(om_1)*cos(fi_1))*cos(fi_m)*cos(om_m);
j.coeffRef(2,4) = -px_2*(-sin(fi_1)*sin(fi_m)*cos(ka_1) - sin(fi_1)*sin(ka_1)*sin(om_m)*cos(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_m)) - py_2*(sin(fi_1)*sin(om_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*sin(om_1)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_1)*sin(om_m)*cos(fi_1)*cos(fi_m)) - pz_2*(-sin(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m) - sin(fi_m)*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m)*cos(om_1)) + (px_1*cos(fi_1) + py_1*sin(fi_1)*sin(om_1) - pz_1*sin(fi_1)*cos(om_1))*cos(fi_m)*cos(om_m) + (-px_1*sin(fi_1)*sin(ka_1) + py_1*sin(ka_1)*sin(om_1)*cos(fi_1) - pz_1*sin(ka_1)*cos(fi_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (-px_1*sin(fi_1)*cos(ka_1) + py_1*sin(om_1)*cos(fi_1)*cos(ka_1) - pz_1*cos(fi_1)*cos(ka_1)*cos(om_1))*sin(fi_m);
j.coeffRef(2,5) = -px_2*(-sin(fi_m)*sin(ka_1)*cos(fi_1) + sin(om_m)*cos(fi_1)*cos(fi_m)*cos(ka_1)) - py_2*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m)) - pz_2*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_m)*cos(fi_m)) + (-px_1*sin(ka_1)*cos(fi_1) - py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)))*sin(fi_m) + (px_1*cos(fi_1)*cos(ka_1) + py_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + pz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)))*sin(om_m)*cos(fi_m);
j.coeffRef(2,6) = -sin(fi_1)*cos(fi_m)*cos(om_m) - sin(fi_m)*cos(fi_1)*cos(ka_1) - sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m);
j.coeffRef(2,7) = (-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) + sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m);
j.coeffRef(2,8) = (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) - cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m);
j.coeffRef(2,9) = 0;
j.coeffRef(2,10) = 0;
j.coeffRef(2,11) = 0;
j.coeffRef(3,0) = 0;
j.coeffRef(3,1) = 0;
j.coeffRef(3,2) = 0;
j.coeffRef(3,3) = -((-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*cos(fi_2)*cos(om_2) + ((-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*sin(om_2)*cos(fi_2))*(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2)) - (((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*cos(fi_2)*cos(om_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*sin(om_2)*cos(fi_2))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2));
j.coeffRef(3,4) = -(((sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*sin(fi_1)*sin(ka_1) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1) - sin(fi_1)*sin(ka_m)*cos(fi_m)*cos(ka_1))*sin(fi_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*sin(om_1)*cos(fi_1) - (-sin(fi_m)*sin(ka_m)*cos(om_m) - sin(om_m)*cos(ka_m))*sin(fi_1)*sin(om_1) - sin(ka_m)*sin(om_1)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(om_2)*cos(fi_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1)*cos(om_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1)*cos(om_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2))*(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2)) - ((-sin(fi_1)*sin(fi_m)*cos(ka_1) - sin(fi_1)*sin(ka_1)*sin(om_m)*cos(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_m))*sin(fi_2) + (-sin(fi_1)*sin(om_1)*cos(fi_m)*cos(om_m) - sin(fi_m)*sin(om_1)*cos(fi_1)*cos(ka_1) - sin(ka_1)*sin(om_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m) - sin(fi_m)*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m)*cos(om_1))*cos(fi_2)*cos(om_2))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2));
j.coeffRef(3,5) = -((-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_m) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_m)*cos(fi_m))*cos(fi_2)*cos(om_2) + (-sin(fi_m)*sin(ka_1)*cos(fi_1) + sin(om_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2)) - (((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)))*sin(om_2)*cos(fi_2) + (-(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(ka_m)*cos(fi_m) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(ka_m)*sin(om_m) - cos(ka_m)*cos(om_m))*cos(fi_1)*cos(ka_1) - sin(ka_1)*sin(ka_m)*cos(fi_1)*cos(fi_m))*sin(fi_2))*(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2));
j.coeffRef(3,6) = 0;
j.coeffRef(3,7) = 0;
j.coeffRef(3,8) = 0;
j.coeffRef(3,9) = -(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*cos(fi_2)*cos(om_2) - (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*sin(om_2)*cos(fi_2))*(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2)) - (((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) + sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*cos(fi_2)*cos(om_2) - (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*sin(om_2)*cos(fi_2))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2));
j.coeffRef(3,10) = -(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(fi_2)*sin(om_2) - (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*sin(fi_2)*cos(om_2) + ((-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) + sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*cos(fi_2))*(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2)) - (-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2))*(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) + sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(fi_2)*sin(om_2) - (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*sin(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*cos(fi_2))/(pow(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_m)*cos(fi_m) - (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_m)*cos(fi_m) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-(-sin(fi_m)*sin(ka_m)*sin(om_m) + cos(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (sin(fi_m)*sin(ka_m)*cos(om_m) + sin(om_m)*cos(ka_m))*sin(fi_1) - sin(ka_m)*cos(fi_1)*cos(fi_m)*cos(ka_1))*sin(fi_2), 2) + pow(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_m)*cos(fi_m) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(fi_m) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(om_m))*sin(om_2)*cos(fi_2) + (-(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*sin(om_m)*cos(fi_m) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_m) + cos(fi_1)*cos(fi_m)*cos(om_1)*cos(om_m))*cos(fi_2)*cos(om_2) + (sin(fi_1)*cos(fi_m)*cos(om_m) + sin(fi_m)*cos(fi_1)*cos(ka_1) + sin(ka_1)*sin(om_m)*cos(fi_1)*cos(fi_m))*sin(fi_2), 2));
j.coeffRef(3,11) = 0;
j.coeffRef(4,0) = 0;
j.coeffRef(4,1) = 0;
j.coeffRef(4,2) = 0;
j.coeffRef(4,3) = -(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*cos(fi_2)*cos(om_2) + (-(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) - (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) - (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2), 2));
j.coeffRef(4,4) = -((-(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*sin(fi_1)*sin(ka_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1) - sin(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2) + ((sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*sin(om_1)*cos(fi_1) + (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*sin(fi_1)*sin(om_1) - sin(om_1)*cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(om_2)*cos(fi_2) + ((sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1)*cos(om_1) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1)*cos(om_1) - cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)*cos(om_1))*cos(fi_2)*cos(om_2))/sqrt(1 - pow(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2), 2));
j.coeffRef(4,5) = -((-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_m)*cos(ka_m) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)))*cos(fi_2)*cos(om_2) + ((-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*cos(fi_1)*cos(ka_1) - sin(ka_1)*cos(fi_1)*cos(fi_m)*cos(ka_m))*sin(fi_2))/sqrt(1 - pow(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2), 2));
j.coeffRef(4,6) = 0;
j.coeffRef(4,7) = 0;
j.coeffRef(4,8) = 0;
j.coeffRef(4,9) = -((-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*cos(fi_2)*cos(om_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2), 2));
j.coeffRef(4,10) = -(-(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) - (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(fi_2)*sin(om_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*sin(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2))/sqrt(1 - pow(-((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2), 2));
j.coeffRef(4,11) = 0;
j.coeffRef(5,0) = 0;
j.coeffRef(5,1) = 0;
j.coeffRef(5,2) = 0;
j.coeffRef(5,3) = -((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)) - ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(5,4) = -((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*sin(om_1)*cos(fi_1) - (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*sin(fi_1)*sin(om_1) + sin(om_1)*cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1)*cos(om_1) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1)*cos(om_1) - cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)*cos(om_1)) + (-(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*sin(fi_1)*sin(ka_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1) - sin(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)) - ((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*(-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*sin(om_1)*cos(fi_1) - (sin(fi_m)*cos(ka_m)*cos(om_m) - sin(ka_m)*sin(om_m))*sin(fi_1)*sin(om_1) + sin(om_1)*cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)) + (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*((sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1)*cos(om_1) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1)*cos(om_1) - cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m)*cos(om_1)) + (-(-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*sin(fi_1)*sin(ka_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1) - sin(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(5,5) = -(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_m)*cos(ka_m) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + ((-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*cos(fi_1)*cos(ka_1) - sin(ka_1)*cos(fi_1)*cos(fi_m)*cos(ka_m))*sin(ka_2)*cos(fi_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)) - (((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_m)*cos(ka_m) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + ((-sin(fi_m)*sin(om_m)*cos(ka_m) - sin(ka_m)*cos(om_m))*cos(fi_1)*cos(ka_1) - sin(ka_1)*cos(fi_1)*cos(fi_m)*cos(ka_m))*cos(fi_2)*cos(ka_2))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(5,6) = 0;
j.coeffRef(5,7) = 0;
j.coeffRef(5,8) = 0;
j.coeffRef(5,9) = -((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)) - ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)))*((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(5,10) = -((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2))*(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2)*cos(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)) - ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2))*(((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - ((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(fi_2)*sin(ka_2))/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(5,11) = -pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) - (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2)/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)) - pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2)/(pow(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*sin(ka_2)*cos(fi_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_m)*cos(ka_m) - (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(om_1)*cos(fi_1)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*((sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_m)*cos(ka_m) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*cos(fi_1)*cos(om_1)) + (-(sin(fi_m)*sin(om_m)*cos(ka_m) + sin(ka_m)*cos(om_m))*sin(ka_1)*cos(fi_1) + (-sin(fi_m)*cos(ka_m)*cos(om_m) + sin(ka_m)*sin(om_m))*sin(fi_1) + cos(fi_1)*cos(fi_m)*cos(ka_1)*cos(ka_m))*cos(fi_2)*cos(ka_2), 2));
}