inline void observation_equation_perspective_camera_with_intrinsics_tait_bryan_cw(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double tx, double ty, double tz, double om, double fi, double ka, double pg_x, double pg_y, double pg_z, double u_kp, double v_kp, double k1, double k2, double k3, double p1, double p2)
{delta.coeffRef(0,0) = -cx - fx*(2.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz)) + u_kp;
delta.coeffRef(1,0) = -cy - fy*(p1*(3.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 2.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz)) + v_kp;
}inline void projection_perspective_camera_with_intrinsics_tait_bryan_cw(double &u, double &v, double fx, double fy, double cx, double cy, double tx, double ty, double tz, double om, double fi, double ka, double pg_x, double pg_y, double pg_z, double k1, double k2, double k3, double p1, double p2)
{u = cx + fx*(2.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
v = cy + fy*(p1*(3.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 2.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
}
inline void observation_equation_perspective_camera_with_intrinsics_tait_bryan_cw_jacobian(Eigen::Matrix<double, 2, 14> &j, double fx, double fy, double tx, double ty, double tz, double om, double fi, double ka, double pg_x, double pg_y, double pg_z, double k1, double k2, double k3, double p1, double p2)
{j.coeffRef(0,0) = -1.0*fx*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz);
j.coeffRef(0,1) = -1.0*fx*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz);
j.coeffRef(0,2) = -1.0*fx*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz);
j.coeffRef(0,3) = -2.0*fx*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2);
j.coeffRef(0,4) = -fx*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(0,5) = -fx*(2.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(6.0*pg_x*cos(fi)*cos(ka) - 6.0*pg_y*sin(ka)*cos(fi) + 6.0*pg_z*sin(fi) + 6.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2*k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3*k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(0,6) = -fx*(2.0*p1*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2*k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3*k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(0,7) = -fx*(-4.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + p2*(-2.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + 1.0*(k1*(-2.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k2*(-4.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 4.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3))*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*(-6.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3))*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) - 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(0,8) = -fx*(2.0*p1*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*p1*(pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - pg_z*cos(fi)*cos(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(1.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 1.0*(k1*(1.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(-pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + pg_z*sin(om)*cos(fi))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(0,9) = -fx*(2.0*p1*(-pg_x*sin(fi)*cos(ka) + pg_y*sin(fi)*sin(ka) + pg_z*cos(fi))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p1*(pg_x*sin(om)*cos(fi)*cos(ka) - pg_y*sin(ka)*sin(om)*cos(fi) + pg_z*sin(fi)*sin(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p1*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + p2*(3.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + 1.0*(k1*(1.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(-pg_x*sin(fi)*cos(ka) + pg_y*sin(fi)*sin(ka) + pg_z*cos(fi))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(pg_x*cos(fi)*cos(ka)*cos(om) - pg_y*sin(ka)*cos(fi)*cos(om) + pg_z*sin(fi)*cos(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(0,10) = -fx*(2.0*p1*(pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p1*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*p1*(-pg_x*sin(ka)*cos(fi) - pg_y*cos(fi)*cos(ka))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(1.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 1.0*(-pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-pg_x*sin(ka)*cos(fi) - pg_y*cos(fi)*cos(ka))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(k1*(1.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(0,11) = -fx*(2.0*p1*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p1*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(1.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 1.0*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 4.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*cos(fi)*cos(ka)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(0,12) = -fx*(2.0*p1*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p1*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(1.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 1.0*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 4.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) - 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*sin(ka)*cos(fi)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(0,13) = -fx*(2.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 4.0*p1*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*p1*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + p2*(-2.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 6.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + 1.0*(k1*(-2.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 2.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(-4.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 4.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 4.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 4.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(-6.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 6.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*sin(fi)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) - 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(1,0) = -1.0*fy*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz);
j.coeffRef(1,1) = -1.0*fy*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz);
j.coeffRef(1,2) = -1.0*fy*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz);
j.coeffRef(1,3) = -fy*(3.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(1,4) = -2.0*fy*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2);
j.coeffRef(1,5) = -fy*(p1*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2*k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3*k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(2.0*pg_x*cos(fi)*cos(ka) - 2.0*pg_y*sin(ka)*cos(fi) + 2.0*pg_z*sin(fi) + 2.0*tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(1,6) = -fy*(p1*(6.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 6.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 6.0*pg_z*sin(om)*cos(fi) + 6.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2*k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3*k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(2.0*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2.0*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2.0*pg_z*sin(om)*cos(fi) + 2.0*ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(1,7) = -fy*(p1*(-6.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) - 4.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(k1*(-2.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k2*(-4.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 4.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3))*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*(-6.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3))*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) - 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(1,8) = -fy*(p1*(3.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 2.0*p2*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*p2*(pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - pg_z*cos(fi)*cos(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_z*sin(om)*cos(fi))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pg_z*cos(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(-pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + pg_z*sin(om)*cos(fi))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(pg_x*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + pg_y*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - pg_z*cos(fi)*cos(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(1,9) = -fy*(p1*(1.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + 2.0*p2*(-pg_x*sin(fi)*cos(ka) + pg_y*sin(fi)*sin(ka) + pg_z*cos(fi))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(pg_x*sin(om)*cos(fi)*cos(ka) - pg_y*sin(ka)*sin(om)*cos(fi) + pg_z*sin(fi)*sin(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(k1*(1.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(-2*pg_x*sin(fi)*cos(ka) + 2*pg_y*sin(fi)*sin(ka) + 2*pg_z*cos(fi))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*pg_x*sin(om)*cos(fi)*cos(ka) - 2*pg_y*sin(ka)*sin(om)*cos(fi) + 2*pg_z*sin(fi)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*pg_x*cos(fi)*cos(ka)*cos(om) - 2*pg_y*sin(ka)*cos(fi)*cos(om) + 2*pg_z*sin(fi)*cos(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(pg_x*sin(om)*cos(fi)*cos(ka) - pg_y*sin(ka)*sin(om)*cos(fi) + pg_z*sin(fi)*sin(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(pg_x*cos(fi)*cos(ka)*cos(om) - pg_y*sin(ka)*cos(fi)*cos(om) + pg_z*sin(fi)*cos(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2));
j.coeffRef(1,10) = -fy*(p1*(3.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 2.0*p2*(pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*p2*(-pg_x*sin(ka)*cos(fi) - pg_y*cos(fi)*cos(ka))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(-pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(2*pg_x*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*pg_y*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*pg_y*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*pg_x*sin(ka)*cos(fi) - 2*pg_y*cos(fi)*cos(ka))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(1,11) = -fy*(p1*(3.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 2.0*p2*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 4.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(ka)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(1,12) = -fy*(p1*(3.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + 2.0*p2*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*p2*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) + 1.0*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(1.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 4.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(3.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) + 3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(ka)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
j.coeffRef(1,13) = -fy*(p1*(-6.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 2.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + 2.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 4.0*p2*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*p2*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*(k1*(-2.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 2.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 2.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 2.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k2*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2))*(-4.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 4.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 4.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 4.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2)*(-6.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3) - 6.0*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*sin(om)*cos(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 6.0*(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx)*sin(fi)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 6.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 3)))*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz) - 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty)*cos(fi)*cos(om)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) - 1.0*(k1*(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2)) + k2*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 2) + k3*pow(1.0*pow(pg_x*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pg_y*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pg_z*sin(om)*cos(fi) + ty, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2) + 1.0*pow(pg_x*cos(fi)*cos(ka) - pg_y*sin(ka)*cos(fi) + pg_z*sin(fi) + tx, 2)/pow(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz, 2), 3) + 1)*sin(om)*cos(fi)/(pg_x*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pg_y*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pg_z*cos(fi)*cos(om) + tz));
}