inline void observation_equation_perspective_camera_rig_tait_bryan_wc(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double tx, double ty, double tz, double om, double fi, double ka, double tx_cal, double ty_cal, double tz_cal, double om_cal, double fi_cal, double ka_cal, double px, double py, double pz, double u_kp, double v_kp)
{delta.coeffRef(0,0) = -cx - 1.0*fx*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) + u_kp;
delta.coeffRef(1,0) = -cy - 1.0*fy*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) + v_kp;
}inline void projection_perspective_camera_rig_tait_bryan_wc(double &u, double &v, double fx, double fy, double cx, double cy, double tx, double ty, double tz, double om, double fi, double ka, double tx_cal, double ty_cal, double tz_cal, double om_cal, double fi_cal, double ka_cal, double px, double py, double pz)
{u = cx + 1.0*fx*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)));
v = cy + 1.0*fy*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)));
}
inline void observation_equation_perspective_camera_rig_tait_bryan_wc_jacobian(Eigen::Matrix<double, 2, 9> &j, double fx, double fy, double cx, double cy, double tx, double ty, double tz, double om, double fi, double ka, double tx_cal, double ty_cal, double tz_cal, double om_cal, double fi_cal, double ka_cal, double px, double py, double pz)
{j.coeffRef(0,0) = 0;
j.coeffRef(0,1) = 0;
j.coeffRef(0,2) = 0;
j.coeffRef(0,3) = -1.0*fx*(px*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(ka)*cos(fi)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal)) + (-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal)) + (sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal))*sin(fi) + (sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal))*sin(ka)*cos(fi)) + ty*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal)) + (sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(om)*cos(fi)) + tz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal)) + (-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fx*(-px*(-sin(fi)*sin(om_cal)*cos(fi_cal) + sin(ka)*cos(fi)*cos(fi_cal)*cos(om_cal)) - py*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*cos(fi_cal)*cos(om_cal) + sin(om)*sin(om_cal)*cos(fi)*cos(fi_cal)) - pz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*cos(fi_cal)*cos(om_cal) - sin(om_cal)*cos(fi)*cos(fi_cal)*cos(om)) - tx*(sin(fi)*sin(om_cal)*cos(fi_cal) - sin(ka)*cos(fi)*cos(fi_cal)*cos(om_cal)) - ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*cos(fi_cal)*cos(om_cal) - sin(om)*sin(om_cal)*cos(fi)*cos(fi_cal)) - tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*cos(fi_cal)*cos(om_cal) + sin(om_cal)*cos(fi)*cos(fi_cal)*cos(om)))*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(0,4) = -1.0*fx*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))*(-px*(-sin(fi)*sin(fi_cal)*cos(om_cal) - sin(fi_cal)*sin(ka)*sin(om_cal)*cos(fi) + cos(fi)*cos(fi_cal)*cos(ka)) - py*(-(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*sin(fi_cal)*sin(om_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal) + sin(fi_cal)*sin(om)*cos(fi)*cos(om_cal)) - pz*(-(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*sin(fi_cal)*sin(om_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal) - sin(fi_cal)*cos(fi)*cos(om)*cos(om_cal)) - tx*(sin(fi)*sin(fi_cal)*cos(om_cal) + sin(fi_cal)*sin(ka)*sin(om_cal)*cos(fi) - cos(fi)*cos(fi_cal)*cos(ka)) - ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(fi_cal)*sin(om_cal) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*cos(fi_cal) - sin(fi_cal)*sin(om)*cos(fi)*cos(om_cal)) - tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(fi_cal)*sin(om_cal) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*cos(fi_cal) + sin(fi_cal)*cos(fi)*cos(om)*cos(om_cal)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2) - 1.0*fx*(px*(-sin(fi)*cos(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka)*cos(ka_cal) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal)*cos(ka_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal)*cos(ka_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(ka_cal)*cos(om_cal)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal)*cos(ka_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal)*cos(ka_cal) - cos(fi)*cos(fi_cal)*cos(ka_cal)*cos(om)*cos(om_cal)) + tx*(sin(fi)*cos(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka)*cos(ka_cal) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)*cos(ka_cal)) + ty*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal)*cos(ka_cal) - (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*sin(fi_cal)*cos(ka_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(ka_cal)*cos(om_cal)) + tz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal)*cos(ka_cal) - (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*sin(fi_cal)*cos(ka_cal) + cos(fi)*cos(fi_cal)*cos(ka_cal)*cos(om)*cos(om_cal)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)));
j.coeffRef(0,5) = -1.0*fx*(px*((sin(fi_cal)*sin(ka_cal)*sin(om_cal) - cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)));
j.coeffRef(0,6) = -1.0*fx*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal))*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(0,7) = -1.0*fx*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fx*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal))*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(0,8) = -1.0*fx*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fx*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))*(px*(-(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) - (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(1,0) = 0;
j.coeffRef(1,1) = 0;
j.coeffRef(1,2) = 0;
j.coeffRef(1,3) = -1.0*fy*(px*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(ka)*cos(fi)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal)) + (sin(fi_cal)*sin(ka_cal)*sin(om_cal) - cos(ka_cal)*cos(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal)) + (-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*cos(fi)*cos(om)) + tx*((sin(fi_cal)*sin(ka_cal)*sin(om_cal) - cos(ka_cal)*cos(om_cal))*sin(fi) + (-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal))*sin(ka)*cos(fi)) + ty*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal)) + (-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(om)*cos(fi)) + tz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*cos(om_cal) - sin(om_cal)*cos(ka_cal)) + (sin(fi_cal)*sin(ka_cal)*sin(om_cal) - cos(ka_cal)*cos(om_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fy*(-px*(-sin(fi)*sin(om_cal)*cos(fi_cal) + sin(ka)*cos(fi)*cos(fi_cal)*cos(om_cal)) - py*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*cos(fi_cal)*cos(om_cal) + sin(om)*sin(om_cal)*cos(fi)*cos(fi_cal)) - pz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*cos(fi_cal)*cos(om_cal) - sin(om_cal)*cos(fi)*cos(fi_cal)*cos(om)) - tx*(sin(fi)*sin(om_cal)*cos(fi_cal) - sin(ka)*cos(fi)*cos(fi_cal)*cos(om_cal)) - ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*cos(fi_cal)*cos(om_cal) - sin(om)*sin(om_cal)*cos(fi)*cos(fi_cal)) - tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*cos(fi_cal)*cos(om_cal) + sin(om_cal)*cos(fi)*cos(fi_cal)*cos(om)))*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(1,4) = -1.0*fy*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))*(-px*(-sin(fi)*sin(fi_cal)*cos(om_cal) - sin(fi_cal)*sin(ka)*sin(om_cal)*cos(fi) + cos(fi)*cos(fi_cal)*cos(ka)) - py*(-(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*sin(fi_cal)*sin(om_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal) + sin(fi_cal)*sin(om)*cos(fi)*cos(om_cal)) - pz*(-(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*sin(fi_cal)*sin(om_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal) - sin(fi_cal)*cos(fi)*cos(om)*cos(om_cal)) - tx*(sin(fi)*sin(fi_cal)*cos(om_cal) + sin(fi_cal)*sin(ka)*sin(om_cal)*cos(fi) - cos(fi)*cos(fi_cal)*cos(ka)) - ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(fi_cal)*sin(om_cal) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*cos(fi_cal) - sin(fi_cal)*sin(om)*cos(fi)*cos(om_cal)) - tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(fi_cal)*sin(om_cal) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*cos(fi_cal) + sin(fi_cal)*cos(fi)*cos(om)*cos(om_cal)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2) - 1.0*fy*(px*(sin(fi)*sin(ka_cal)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*sin(ka_cal)*cos(fi)*cos(ka) + sin(ka)*sin(ka_cal)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(ka_cal)*sin(om_cal)*cos(fi_cal) - (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*sin(fi_cal)*sin(ka_cal) - sin(ka_cal)*sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(ka_cal)*sin(om_cal)*cos(fi_cal) - (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*sin(fi_cal)*sin(ka_cal) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*sin(ka_cal)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*sin(ka_cal)*cos(fi)*cos(ka) - sin(ka)*sin(ka_cal)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*(-(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*sin(ka_cal)*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal)*sin(ka_cal) + sin(ka_cal)*sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*(-(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*sin(ka_cal)*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal)*sin(ka_cal) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)));
j.coeffRef(1,5) = -1.0*fy*(px*((sin(fi_cal)*sin(om_cal)*cos(ka_cal) + sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal))*sin(fi) - cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal)) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal)) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*sin(fi) + cos(fi)*cos(fi_cal)*cos(ka)*cos(ka_cal)) + ty*((sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*cos(fi_cal)*cos(ka_cal) + (sin(fi_cal)*cos(ka_cal)*cos(om_cal) - sin(ka_cal)*sin(om_cal))*sin(om)*cos(fi)) + tz*((-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-sin(fi_cal)*sin(om_cal)*cos(ka_cal) - sin(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*cos(fi_cal)*cos(ka_cal) + (-sin(fi_cal)*cos(ka_cal)*cos(om_cal) + sin(ka_cal)*sin(om_cal))*cos(fi)*cos(om)))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)));
j.coeffRef(1,6) = -1.0*fy*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fy*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal))*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(1,7) = -1.0*fy*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fy*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal))*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
j.coeffRef(1,8) = -1.0*fy*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om))/(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))) - 1.0*fy*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal))*(px*(-(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) - sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + py*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + pz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)) + tx*((-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal))*sin(ka)*cos(fi) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(fi) + sin(ka_cal)*cos(fi)*cos(fi_cal)*cos(ka)) + ty*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(ka_cal)*cos(fi_cal) + (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*sin(om)*cos(fi)) + tz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*(-sin(fi_cal)*sin(ka_cal)*sin(om_cal) + cos(ka_cal)*cos(om_cal)) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(ka_cal)*cos(fi_cal) - (sin(fi_cal)*sin(ka_cal)*cos(om_cal) + sin(om_cal)*cos(ka_cal))*cos(fi)*cos(om)))/pow(px*(sin(fi)*cos(fi_cal)*cos(om_cal) + sin(fi_cal)*cos(fi)*cos(ka) + sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + py*(-(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) + (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) - sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + pz*(-(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) + (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) + cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)) + tx*(-sin(fi)*cos(fi_cal)*cos(om_cal) - sin(fi_cal)*cos(fi)*cos(ka) - sin(ka)*sin(om_cal)*cos(fi)*cos(fi_cal)) + ty*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))*sin(om_cal)*cos(fi_cal) - (sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))*sin(fi_cal) + sin(om)*cos(fi)*cos(fi_cal)*cos(om_cal)) + tz*((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))*sin(om_cal)*cos(fi_cal) - (-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))*sin(fi_cal) - cos(fi)*cos(fi_cal)*cos(om)*cos(om_cal)), 2);
}