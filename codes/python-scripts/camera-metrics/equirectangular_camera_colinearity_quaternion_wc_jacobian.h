inline void observation_equation_equrectangular_camera_colinearity_quaternion_wc(Eigen::Matrix<double, 2, 1> &delta, double rows, double cols, double pi, double px, double py, double pz, double q0, double q1, double q2, double q3, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp)
{delta.coeffRef(0,0) = -cols*(0.5 + 0.5*atan2((px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)), (pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))/pi) + u_kp;
delta.coeffRef(1,0) = -rows*(0.5 + asin((py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))/pi) + v_kp;
}
inline void observation_equation_equrectangular_camera_colinearity_quaternion_wc_jacobian(Eigen::Matrix<double, 2, 10, Eigen::RowMajor> &j, double rows, double cols, double pi, double px, double py, double pz, double q0, double q1, double q2, double q3, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp)
{j.coeffRef(0,0) = -0.5*cols*((pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), -1.0/2.0) + (-px - tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) - tie_py*(-2.0*q0*q3 + 2.0*q1*q2) - tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) - (-px - tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) - tie_py*(-2.0*q0*q3 + 2.0*q1*q2) - tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)))/pi;
j.coeffRef(0,1) = 0;
j.coeffRef(0,2) = -0.5*cols*(-(pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), -1.0/2.0) + (-pz - tie_px*(-2.0*q0*q2 + 2.0*q1*q3) - tie_py*(2.0*q0*q1 + 2.0*q2*q3) - tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) + (px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(-pz - tie_px*(-2.0*q0*q2 + 2.0*q1*q3) - tie_py*(2.0*q0*q1 + 2.0*q2*q3) - tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)))/pi;
j.coeffRef(0,3) = -0.5*cols*(-((2.0*q1*tie_py - 2.0*q2*tie_px)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_py - 4.0*q2*tie_px)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) + ((2.0*q2*tie_pz - 2.0*q3*tie_py)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_py - 4.0*q2*tie_px)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(0,4) = -0.5*cols*(((2.0*q2*tie_py + 2.0*q3*tie_pz)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(4.0*q0*tie_py - 8*q1*tie_pz + 4.0*q3*tie_px)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) - ((2.0*q0*tie_py - 4*q1*tie_pz + 2.0*q3*tie_px)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(4.0*q0*tie_py - 8*q1*tie_pz + 4.0*q3*tie_px)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(0,5) = -0.5*cols*(-((-2.0*q0*tie_px - 4*q2*tie_pz + 2.0*q3*tie_py)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4.0*q0*tie_px - 8*q2*tie_pz + 4.0*q3*tie_py)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) + ((2.0*q0*tie_pz + 2.0*q1*tie_py - 4*q2*tie_px)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4.0*q0*tie_px - 8*q2*tie_pz + 4.0*q3*tie_py)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(0,6) = -0.5*cols*(-((2.0*q1*tie_px + 2.0*q2*tie_py)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_px + 4.0*q2*tie_py)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) + ((-2.0*q0*tie_py + 2.0*q1*tie_pz - 4*q3*tie_px)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_px + 4.0*q2*tie_py)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(0,7) = -0.5*cols*(-((-2.0*q0*q2 + 2.0*q1*q3)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(-4.0*q0*q2 + 4.0*q1*q3)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) + ((-2*pow(q2, 2) - 2*pow(q3, 2) + 1)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(-4.0*q0*q2 + 4.0*q1*q3)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(0,8) = -0.5*cols*(-((2.0*q0*q1 + 2.0*q2*q3)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q0*q1 + 4.0*q2*q3)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) + ((-2.0*q0*q3 + 2.0*q1*q2)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q0*q1 + 4.0*q2*q3)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(0,9) = -0.5*cols*(((2.0*q0*q2 + 2.0*q1*q3)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(-4*pow(q1, 2) - 4*pow(q2, 2) + 2)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))) - ((-2*pow(q1, 2) - 2*pow(q2, 2) + 1)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(-4*pow(q1, 2) - 4*pow(q2, 2) + 2)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)))*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/((pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))))/pi;
j.coeffRef(1,0) = -rows*(-px - tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) - tie_py*(-2.0*q0*q3 + 2.0*q1*q2) - tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0));
j.coeffRef(1,1) = -rows*(pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), -1.0/2.0) + (-py - tie_px*(2.0*q0*q3 + 2.0*q1*q2) - tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,2) = -rows*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(-pz - tie_px*(-2.0*q0*q2 + 2.0*q1*q3) - tie_py*(2.0*q0*q1 + 2.0*q2*q3) - tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0));
j.coeffRef(1,3) = -rows*((-2.0*q1*tie_pz + 2.0*q3*tie_px)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_py - 4.0*q2*tie_px)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,4) = -rows*((-2.0*q0*tie_pz - 4*q1*tie_py + 2.0*q2*tie_px)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(4.0*q0*tie_py - 8*q1*tie_pz + 4.0*q3*tie_px)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,5) = -rows*((2.0*q1*tie_px + 2.0*q3*tie_pz)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4.0*q0*tie_px - 8*q2*tie_pz + 4.0*q3*tie_py)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,6) = -rows*((2.0*q0*tie_px + 2.0*q2*tie_pz - 4*q3*tie_py)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q1*tie_px + 4.0*q2*tie_py)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,7) = -rows*((2.0*q0*q3 + 2.0*q1*q2)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(-4.0*q0*q2 + 4.0*q1*q3)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,8) = -rows*((-2*pow(q1, 2) - 2*pow(q3, 2) + 1)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(4.0*q0*q1 + 4.0*q2*q3)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0/2.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
j.coeffRef(1,9) = -rows*((-2.0*q0*q1 + 2.0*q2*q3)/sqrt(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + (-1.0/2.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3)) - 1.0/2.0*(-4*pow(q1, 2) - 4*pow(q2, 2) + 2)*(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/(pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2) + pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2) + pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))));
}