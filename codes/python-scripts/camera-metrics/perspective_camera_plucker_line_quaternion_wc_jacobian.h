inline void observation_equation_perspective_camera_plucker_line_quaternion_wc(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double px, double py, double pz, double q0, double q1, double q2, double q3, double mx_w, double my_w, double mz_w, double lx_w, double ly_w, double lz_w, double u_s, double v_s, double u_e, double v_e)
{delta.coeffRef(0,0) = -(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2));
delta.coeffRef(1,0) = -(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2));
}
inline void observation_equation_perspective_camera_plucker_line_quaternion_wc_jacobian(Eigen::Matrix<double, 2, 7, Eigen::RowMajor> &j, double fx, double fy, double cx, double cy, double px, double py, double pz, double q0, double q1, double q2, double q3, double mx_w, double my_w, double mz_w, double lx_w, double ly_w, double lz_w, double u_s, double v_s, double u_e, double v_e)
{j.coeffRef(0,0) = -(-cx*fy*(ly_w*(2.0*q0*q2 - 2.0*q1*q3) + lz_w*(2.0*q0*q3 + 2.0*q1*q2)) - cy*fx*(ly_w*(-2.0*q0*q1 - 2.0*q2*q3) + lz_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + fx*fy*(ly_w*(2*pow(q1, 2) + 2*pow(q2, 2) - 1) + lz_w*(-2.0*q0*q1 + 2.0*q2*q3)) + fx*v_s*(ly_w*(-2.0*q0*q1 - 2.0*q2*q3) + lz_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + fy*u_s*(ly_w*(2.0*q0*q2 - 2.0*q1*q3) + lz_w*(2.0*q0*q3 + 2.0*q1*q2)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*ly_w*(-2.0*q0*q1 - 2.0*q2*q3) + 2*lz_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1))*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*ly_w*(2.0*q0*q2 - 2.0*q1*q3) + 2*lz_w*(2.0*q0*q3 + 2.0*q1*q2))*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(0,1) = -(-cx*fy*(lx_w*(-2.0*q0*q2 + 2.0*q1*q3) + lz_w*(2*pow(q2, 2) + 2*pow(q3, 2) - 1)) - cy*fx*(lx_w*(2.0*q0*q1 + 2.0*q2*q3) + lz_w*(2.0*q0*q3 - 2.0*q1*q2)) + fx*fy*(lx_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + lz_w*(-2.0*q0*q2 - 2.0*q1*q3)) + fx*v_s*(lx_w*(2.0*q0*q1 + 2.0*q2*q3) + lz_w*(2.0*q0*q3 - 2.0*q1*q2)) + fy*u_s*(lx_w*(-2.0*q0*q2 + 2.0*q1*q3) + lz_w*(2*pow(q2, 2) + 2*pow(q3, 2) - 1)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2.0*q0*q1 + 2.0*q2*q3) + 2*lz_w*(2.0*q0*q3 - 2.0*q1*q2))*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*q0*q2 + 2.0*q1*q3) + 2*lz_w*(2*pow(q2, 2) + 2*pow(q3, 2) - 1))*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(0,2) = -(-cx*fy*(lx_w*(-2.0*q0*q3 - 2.0*q1*q2) + ly_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) - cy*fx*(lx_w*(2*pow(q1, 2) + 2*pow(q3, 2) - 1) + ly_w*(-2.0*q0*q3 + 2.0*q1*q2)) + fx*fy*(lx_w*(2.0*q0*q1 - 2.0*q2*q3) + ly_w*(2.0*q0*q2 + 2.0*q1*q3)) + fx*v_s*(lx_w*(2*pow(q1, 2) + 2*pow(q3, 2) - 1) + ly_w*(-2.0*q0*q3 + 2.0*q1*q2)) + fy*u_s*(lx_w*(-2.0*q0*q3 - 2.0*q1*q2) + ly_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2*pow(q1, 2) + 2*pow(q3, 2) - 1) + 2*ly_w*(-2.0*q0*q3 + 2.0*q1*q2))*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*q0*q3 - 2.0*q1*q2) + 2*ly_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1))*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(0,3) = -(-cx*fy*(lx_w*(-2.0*py*q2 - 2.0*pz*q3) + 2.0*ly_w*px*q2 + 2.0*lz_w*px*q3 + 2.0*my_w*q3 - 2.0*mz_w*q2) - cy*fx*(2.0*lx_w*py*q1 + ly_w*(-2.0*px*q1 - 2.0*pz*q3) + 2.0*lz_w*py*q3 - 2.0*mx_w*q3 + 2.0*mz_w*q1) + fx*fy*(2.0*lx_w*pz*q1 + 2.0*ly_w*pz*q2 + lz_w*(-2.0*px*q1 - 2.0*py*q2) + 2.0*mx_w*q2 - 2.0*my_w*q1) + fx*v_s*(2.0*lx_w*py*q1 + ly_w*(-2.0*px*q1 - 2.0*pz*q3) + 2.0*lz_w*py*q3 - 2.0*mx_w*q3 + 2.0*mz_w*q1) + fy*u_s*(lx_w*(-2.0*py*q2 - 2.0*pz*q3) + 2.0*ly_w*px*q2 + 2.0*lz_w*px*q3 + 2.0*my_w*q3 - 2.0*mz_w*q2))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(4.0*lx_w*py*q1 + 2*ly_w*(-2.0*px*q1 - 2.0*pz*q3) + 4.0*lz_w*py*q3 - 4.0*mx_w*q3 + 4.0*mz_w*q1)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*py*q2 - 2.0*pz*q3) + 4.0*ly_w*px*q2 + 4.0*lz_w*px*q3 + 4.0*my_w*q3 - 4.0*mz_w*q2)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(0,4) = -(-cx*fy*(lx_w*(2.0*py*q3 - 2.0*pz*q2) - 2.0*ly_w*px*q3 + 2.0*lz_w*px*q2 + 2.0*my_w*q2 + 2.0*mz_w*q3) - cy*fx*(lx_w*(2.0*py*q0 + 4*pz*q1) + ly_w*(-2.0*px*q0 + 2.0*pz*q2) + lz_w*(-4*px*q1 - 2.0*py*q2) + 2.0*mx_w*q2 - 4*my_w*q1 + 2.0*mz_w*q0) + fx*fy*(lx_w*(-4*py*q1 + 2.0*pz*q0) + ly_w*(4*px*q1 + 2.0*pz*q3) + lz_w*(-2.0*px*q0 - 2.0*py*q3) + 2.0*mx_w*q3 - 2.0*my_w*q0 - 4*mz_w*q1) + fx*v_s*(lx_w*(2.0*py*q0 + 4*pz*q1) + ly_w*(-2.0*px*q0 + 2.0*pz*q2) + lz_w*(-4*px*q1 - 2.0*py*q2) + 2.0*mx_w*q2 - 4*my_w*q1 + 2.0*mz_w*q0) + fy*u_s*(lx_w*(2.0*py*q3 - 2.0*pz*q2) - 2.0*ly_w*px*q3 + 2.0*lz_w*px*q2 + 2.0*my_w*q2 + 2.0*mz_w*q3))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2.0*py*q0 + 4*pz*q1) + 2*ly_w*(-2.0*px*q0 + 2.0*pz*q2) + 2*lz_w*(-4*px*q1 - 2.0*py*q2) + 4.0*mx_w*q2 - 8*my_w*q1 + 4.0*mz_w*q0)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(2.0*py*q3 - 2.0*pz*q2) - 4.0*ly_w*px*q3 + 4.0*lz_w*px*q2 + 4.0*my_w*q2 + 4.0*mz_w*q3)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(0,5) = -(-cx*fy*(lx_w*(-2.0*py*q0 - 2.0*pz*q1) + ly_w*(2.0*px*q0 - 4*pz*q2) + lz_w*(2.0*px*q1 + 4*py*q2) - 4*mx_w*q2 + 2.0*my_w*q1 - 2.0*mz_w*q0) - cy*fx*(2.0*lx_w*py*q3 + ly_w*(-2.0*px*q3 + 2.0*pz*q1) - 2.0*lz_w*py*q1 + 2.0*mx_w*q1 + 2.0*mz_w*q3) + fx*fy*(lx_w*(-4*py*q2 - 2.0*pz*q3) + ly_w*(4*px*q2 + 2.0*pz*q0) + lz_w*(2.0*px*q3 - 2.0*py*q0) + 2.0*mx_w*q0 + 2.0*my_w*q3 - 4*mz_w*q2) + fx*v_s*(2.0*lx_w*py*q3 + ly_w*(-2.0*px*q3 + 2.0*pz*q1) - 2.0*lz_w*py*q1 + 2.0*mx_w*q1 + 2.0*mz_w*q3) + fy*u_s*(lx_w*(-2.0*py*q0 - 2.0*pz*q1) + ly_w*(2.0*px*q0 - 4*pz*q2) + lz_w*(2.0*px*q1 + 4*py*q2) - 4*mx_w*q2 + 2.0*my_w*q1 - 2.0*mz_w*q0))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(4.0*lx_w*py*q3 + 2*ly_w*(-2.0*px*q3 + 2.0*pz*q1) - 4.0*lz_w*py*q1 + 4.0*mx_w*q1 + 4.0*mz_w*q3)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*py*q0 - 2.0*pz*q1) + 2*ly_w*(2.0*px*q0 - 4*pz*q2) + 2*lz_w*(2.0*px*q1 + 4*py*q2) - 8*mx_w*q2 + 4.0*my_w*q1 - 4.0*mz_w*q0)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(0,6) = -(-cx*fy*(lx_w*(2.0*py*q1 - 2.0*pz*q0) + ly_w*(-2.0*px*q1 - 4*pz*q3) + lz_w*(2.0*px*q0 + 4*py*q3) - 4*mx_w*q3 + 2.0*my_w*q0 + 2.0*mz_w*q1) - cy*fx*(lx_w*(2.0*py*q2 + 4*pz*q3) + ly_w*(-2.0*px*q2 - 2.0*pz*q0) + lz_w*(-4*px*q3 + 2.0*py*q0) - 2.0*mx_w*q0 - 4*my_w*q3 + 2.0*mz_w*q2) + fx*fy*(-2.0*lx_w*pz*q2 + 2.0*ly_w*pz*q1 + lz_w*(2.0*px*q2 - 2.0*py*q1) + 2.0*mx_w*q1 + 2.0*my_w*q2) + fx*v_s*(lx_w*(2.0*py*q2 + 4*pz*q3) + ly_w*(-2.0*px*q2 - 2.0*pz*q0) + lz_w*(-4*px*q3 + 2.0*py*q0) - 2.0*mx_w*q0 - 4*my_w*q3 + 2.0*mz_w*q2) + fy*u_s*(lx_w*(2.0*py*q1 - 2.0*pz*q0) + ly_w*(-2.0*px*q1 - 4*pz*q3) + lz_w*(2.0*px*q0 + 4*py*q3) - 4*mx_w*q3 + 2.0*my_w*q0 + 2.0*mz_w*q1))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2.0*py*q2 + 4*pz*q3) + 2*ly_w*(-2.0*px*q2 - 2.0*pz*q0) + 2*lz_w*(-4*px*q3 + 2.0*py*q0) - 4.0*mx_w*q0 - 8*my_w*q3 + 4.0*mz_w*q2)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(2.0*py*q1 - 2.0*pz*q0) + 2*ly_w*(-2.0*px*q1 - 4*pz*q3) + 2*lz_w*(2.0*px*q0 + 4*py*q3) - 8*mx_w*q3 + 4.0*my_w*q0 + 4.0*mz_w*q1)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_s*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_s*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,0) = -(-cx*fy*(ly_w*(2.0*q0*q2 - 2.0*q1*q3) + lz_w*(2.0*q0*q3 + 2.0*q1*q2)) - cy*fx*(ly_w*(-2.0*q0*q1 - 2.0*q2*q3) + lz_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + fx*fy*(ly_w*(2*pow(q1, 2) + 2*pow(q2, 2) - 1) + lz_w*(-2.0*q0*q1 + 2.0*q2*q3)) + fx*v_e*(ly_w*(-2.0*q0*q1 - 2.0*q2*q3) + lz_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + fy*u_e*(ly_w*(2.0*q0*q2 - 2.0*q1*q3) + lz_w*(2.0*q0*q3 + 2.0*q1*q2)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*ly_w*(-2.0*q0*q1 - 2.0*q2*q3) + 2*lz_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1))*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*ly_w*(2.0*q0*q2 - 2.0*q1*q3) + 2*lz_w*(2.0*q0*q3 + 2.0*q1*q2))*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,1) = -(-cx*fy*(lx_w*(-2.0*q0*q2 + 2.0*q1*q3) + lz_w*(2*pow(q2, 2) + 2*pow(q3, 2) - 1)) - cy*fx*(lx_w*(2.0*q0*q1 + 2.0*q2*q3) + lz_w*(2.0*q0*q3 - 2.0*q1*q2)) + fx*fy*(lx_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + lz_w*(-2.0*q0*q2 - 2.0*q1*q3)) + fx*v_e*(lx_w*(2.0*q0*q1 + 2.0*q2*q3) + lz_w*(2.0*q0*q3 - 2.0*q1*q2)) + fy*u_e*(lx_w*(-2.0*q0*q2 + 2.0*q1*q3) + lz_w*(2*pow(q2, 2) + 2*pow(q3, 2) - 1)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2.0*q0*q1 + 2.0*q2*q3) + 2*lz_w*(2.0*q0*q3 - 2.0*q1*q2))*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*q0*q2 + 2.0*q1*q3) + 2*lz_w*(2*pow(q2, 2) + 2*pow(q3, 2) - 1))*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,2) = -(-cx*fy*(lx_w*(-2.0*q0*q3 - 2.0*q1*q2) + ly_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) - cy*fx*(lx_w*(2*pow(q1, 2) + 2*pow(q3, 2) - 1) + ly_w*(-2.0*q0*q3 + 2.0*q1*q2)) + fx*fy*(lx_w*(2.0*q0*q1 - 2.0*q2*q3) + ly_w*(2.0*q0*q2 + 2.0*q1*q3)) + fx*v_e*(lx_w*(2*pow(q1, 2) + 2*pow(q3, 2) - 1) + ly_w*(-2.0*q0*q3 + 2.0*q1*q2)) + fy*u_e*(lx_w*(-2.0*q0*q3 - 2.0*q1*q2) + ly_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2*pow(q1, 2) + 2*pow(q3, 2) - 1) + 2*ly_w*(-2.0*q0*q3 + 2.0*q1*q2))*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*q0*q3 - 2.0*q1*q2) + 2*ly_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1))*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,3) = -(-cx*fy*(lx_w*(-2.0*py*q2 - 2.0*pz*q3) + 2.0*ly_w*px*q2 + 2.0*lz_w*px*q3 + 2.0*my_w*q3 - 2.0*mz_w*q2) - cy*fx*(2.0*lx_w*py*q1 + ly_w*(-2.0*px*q1 - 2.0*pz*q3) + 2.0*lz_w*py*q3 - 2.0*mx_w*q3 + 2.0*mz_w*q1) + fx*fy*(2.0*lx_w*pz*q1 + 2.0*ly_w*pz*q2 + lz_w*(-2.0*px*q1 - 2.0*py*q2) + 2.0*mx_w*q2 - 2.0*my_w*q1) + fx*v_e*(2.0*lx_w*py*q1 + ly_w*(-2.0*px*q1 - 2.0*pz*q3) + 2.0*lz_w*py*q3 - 2.0*mx_w*q3 + 2.0*mz_w*q1) + fy*u_e*(lx_w*(-2.0*py*q2 - 2.0*pz*q3) + 2.0*ly_w*px*q2 + 2.0*lz_w*px*q3 + 2.0*my_w*q3 - 2.0*mz_w*q2))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(4.0*lx_w*py*q1 + 2*ly_w*(-2.0*px*q1 - 2.0*pz*q3) + 4.0*lz_w*py*q3 - 4.0*mx_w*q3 + 4.0*mz_w*q1)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*py*q2 - 2.0*pz*q3) + 4.0*ly_w*px*q2 + 4.0*lz_w*px*q3 + 4.0*my_w*q3 - 4.0*mz_w*q2)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,4) = -(-cx*fy*(lx_w*(2.0*py*q3 - 2.0*pz*q2) - 2.0*ly_w*px*q3 + 2.0*lz_w*px*q2 + 2.0*my_w*q2 + 2.0*mz_w*q3) - cy*fx*(lx_w*(2.0*py*q0 + 4*pz*q1) + ly_w*(-2.0*px*q0 + 2.0*pz*q2) + lz_w*(-4*px*q1 - 2.0*py*q2) + 2.0*mx_w*q2 - 4*my_w*q1 + 2.0*mz_w*q0) + fx*fy*(lx_w*(-4*py*q1 + 2.0*pz*q0) + ly_w*(4*px*q1 + 2.0*pz*q3) + lz_w*(-2.0*px*q0 - 2.0*py*q3) + 2.0*mx_w*q3 - 2.0*my_w*q0 - 4*mz_w*q1) + fx*v_e*(lx_w*(2.0*py*q0 + 4*pz*q1) + ly_w*(-2.0*px*q0 + 2.0*pz*q2) + lz_w*(-4*px*q1 - 2.0*py*q2) + 2.0*mx_w*q2 - 4*my_w*q1 + 2.0*mz_w*q0) + fy*u_e*(lx_w*(2.0*py*q3 - 2.0*pz*q2) - 2.0*ly_w*px*q3 + 2.0*lz_w*px*q2 + 2.0*my_w*q2 + 2.0*mz_w*q3))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2.0*py*q0 + 4*pz*q1) + 2*ly_w*(-2.0*px*q0 + 2.0*pz*q2) + 2*lz_w*(-4*px*q1 - 2.0*py*q2) + 4.0*mx_w*q2 - 8*my_w*q1 + 4.0*mz_w*q0)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(2.0*py*q3 - 2.0*pz*q2) - 4.0*ly_w*px*q3 + 4.0*lz_w*px*q2 + 4.0*my_w*q2 + 4.0*mz_w*q3)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,5) = -(-cx*fy*(lx_w*(-2.0*py*q0 - 2.0*pz*q1) + ly_w*(2.0*px*q0 - 4*pz*q2) + lz_w*(2.0*px*q1 + 4*py*q2) - 4*mx_w*q2 + 2.0*my_w*q1 - 2.0*mz_w*q0) - cy*fx*(2.0*lx_w*py*q3 + ly_w*(-2.0*px*q3 + 2.0*pz*q1) - 2.0*lz_w*py*q1 + 2.0*mx_w*q1 + 2.0*mz_w*q3) + fx*fy*(lx_w*(-4*py*q2 - 2.0*pz*q3) + ly_w*(4*px*q2 + 2.0*pz*q0) + lz_w*(2.0*px*q3 - 2.0*py*q0) + 2.0*mx_w*q0 + 2.0*my_w*q3 - 4*mz_w*q2) + fx*v_e*(2.0*lx_w*py*q3 + ly_w*(-2.0*px*q3 + 2.0*pz*q1) - 2.0*lz_w*py*q1 + 2.0*mx_w*q1 + 2.0*mz_w*q3) + fy*u_e*(lx_w*(-2.0*py*q0 - 2.0*pz*q1) + ly_w*(2.0*px*q0 - 4*pz*q2) + lz_w*(2.0*px*q1 + 4*py*q2) - 4*mx_w*q2 + 2.0*my_w*q1 - 2.0*mz_w*q0))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(4.0*lx_w*py*q3 + 2*ly_w*(-2.0*px*q3 + 2.0*pz*q1) - 4.0*lz_w*py*q1 + 4.0*mx_w*q1 + 4.0*mz_w*q3)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-2.0*py*q0 - 2.0*pz*q1) + 2*ly_w*(2.0*px*q0 - 4*pz*q2) + 2*lz_w*(2.0*px*q1 + 4*py*q2) - 8*mx_w*q2 + 4.0*my_w*q1 - 4.0*mz_w*q0)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
j.coeffRef(1,6) = -(-cx*fy*(lx_w*(2.0*py*q1 - 2.0*pz*q0) + ly_w*(-2.0*px*q1 - 4*pz*q3) + lz_w*(2.0*px*q0 + 4*py*q3) - 4*mx_w*q3 + 2.0*my_w*q0 + 2.0*mz_w*q1) - cy*fx*(lx_w*(2.0*py*q2 + 4*pz*q3) + ly_w*(-2.0*px*q2 - 2.0*pz*q0) + lz_w*(-4*px*q3 + 2.0*py*q0) - 2.0*mx_w*q0 - 4*my_w*q3 + 2.0*mz_w*q2) + fx*fy*(-2.0*lx_w*pz*q2 + 2.0*ly_w*pz*q1 + lz_w*(2.0*px*q2 - 2.0*py*q1) + 2.0*mx_w*q1 + 2.0*my_w*q2) + fx*v_e*(lx_w*(2.0*py*q2 + 4*pz*q3) + ly_w*(-2.0*px*q2 - 2.0*pz*q0) + lz_w*(-4*px*q3 + 2.0*py*q0) - 2.0*mx_w*q0 - 4*my_w*q3 + 2.0*mz_w*q2) + fy*u_e*(lx_w*(2.0*py*q1 - 2.0*pz*q0) + ly_w*(-2.0*px*q1 - 4*pz*q3) + lz_w*(2.0*px*q0 + 4*py*q3) - 4*mx_w*q3 + 2.0*my_w*q0 + 2.0*mz_w*q1))/sqrt(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(2.0*py*q2 + 4*pz*q3) + 2*ly_w*(-2.0*px*q2 - 2.0*pz*q0) + 2*lz_w*(-4*px*q3 + 2.0*py*q0) - 4.0*mx_w*q0 - 8*my_w*q3 + 4.0*mz_w*q2)*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(2.0*py*q1 - 2.0*pz*q0) + 2*ly_w*(-2.0*px*q1 - 4*pz*q3) + 2*lz_w*(2.0*px*q0 + 4*py*q3) - 8*mx_w*q3 + 4.0*my_w*q0 + 4.0*mz_w*q1)*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))*(-cx*fy*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)) - cy*fx*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fx*fy*(lx_w*(py*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) - pz*(-2.0*q0*q1 + 2.0*q2*q3)) + ly_w*(-px*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1) + pz*(2.0*q0*q2 + 2.0*q1*q3)) + lz_w*(px*(-2.0*q0*q1 + 2.0*q2*q3) - py*(2.0*q0*q2 + 2.0*q1*q3)) + mx_w*(2.0*q0*q2 + 2.0*q1*q3) + my_w*(-2.0*q0*q1 + 2.0*q2*q3) + mz_w*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + fx*v_e*(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3)) + fy*u_e*(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3)))/pow(pow(fx, 2)*pow(lx_w*(py*(2.0*q0*q1 + 2.0*q2*q3) - pz*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)) + ly_w*(-px*(2.0*q0*q1 + 2.0*q2*q3) + pz*(-2.0*q0*q3 + 2.0*q1*q2)) + lz_w*(px*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) - py*(-2.0*q0*q3 + 2.0*q1*q2)) + mx_w*(-2.0*q0*q3 + 2.0*q1*q2) + my_w*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + mz_w*(2.0*q0*q1 + 2.0*q2*q3), 2) + pow(fy, 2)*pow(lx_w*(py*(-2.0*q0*q2 + 2.0*q1*q3) - pz*(2.0*q0*q3 + 2.0*q1*q2)) + ly_w*(-px*(-2.0*q0*q2 + 2.0*q1*q3) + pz*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + lz_w*(px*(2.0*q0*q3 + 2.0*q1*q2) - py*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)) + mx_w*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + my_w*(2.0*q0*q3 + 2.0*q1*q2) + mz_w*(-2.0*q0*q2 + 2.0*q1*q3), 2), 3.0/2.0);
}