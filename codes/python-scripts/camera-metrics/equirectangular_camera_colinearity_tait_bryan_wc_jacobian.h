inline void equrectangular_camera_colinearity_tait_bryan_wc(double &u, double &v, double rows, double cols, double pi, double tx, double ty, double tz, double om, double fi, double ka, double px, double py, double pz)
{u = cols*(0.5 + 0.5*atan2((px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)), (px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/pi);
v = rows*(0.5 + asin((px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/pi);
}
inline void observation_equation_equrectangular_camera_colinearity_tait_bryan_wc(Eigen::Matrix<double, 2, 1> &delta, double rows, double cols, double pi, double tx, double ty, double tz, double om, double fi, double ka, double px, double py, double pz, double u_kp, double v_kp)
{delta.coeffRef(0,0) = -cols*(0.5 + 0.5*atan2((px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)), (px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/pi) + u_kp;
delta.coeffRef(1,0) = -rows*(0.5 + asin((px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/pi) + v_kp;
}
inline void observation_equation_equrectangular_camera_colinearity_tait_bryan_wc_jacobian(Eigen::Matrix<double, 2, 9, Eigen::RowMajor> &j, double rows, double cols, double pi, double tx, double ty, double tz, double om, double fi, double ka, double px, double py, double pz, double u_kp, double v_kp)
{j.coeffRef(0,0) = -0.5*cols*((pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), -1.0/2.0) + (-px*cos(fi)*cos(ka) + py*sin(ka)*cos(fi) - pz*sin(fi) - tx)*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) - (px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)*(-px*cos(fi)*cos(ka) + py*sin(ka)*cos(fi) - pz*sin(fi) - tx)*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 2)))/pi;
j.coeffRef(0,1) = 0;
j.coeffRef(0,2) = -0.5*cols*(-(pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), -1.0/2.0) + (-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*cos(fi)*cos(om) - tz)*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) + (-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*cos(fi)*cos(om) - tz)*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 2)))/pi;
j.coeffRef(0,3) = -0.5*cols*((-1.0/2.0*(2*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*pz*sin(om)*cos(fi))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - 1.0/2.0*(2*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pz*cos(fi)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 2)) - ((-1.0/2.0*(2*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*pz*sin(om)*cos(fi))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - 1.0/2.0*(2*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pz*cos(fi)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + (px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))))/pi;
j.coeffRef(0,4) = -0.5*cols*(-((-1.0/2.0*(-2*px*sin(fi)*cos(ka) + 2*py*sin(fi)*sin(ka) + 2*pz*cos(fi))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx) - 1.0/2.0*(2*px*sin(om)*cos(fi)*cos(ka) - 2*py*sin(ka)*sin(om)*cos(fi) + 2*pz*sin(fi)*sin(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(-2*px*cos(fi)*cos(ka)*cos(om) + 2*py*sin(ka)*cos(fi)*cos(om) - 2*pz*sin(fi)*cos(om))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + (-px*cos(fi)*cos(ka)*cos(om) + py*sin(ka)*cos(fi)*cos(om) - pz*sin(fi)*cos(om))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) + ((-1.0/2.0*(-2*px*sin(fi)*cos(ka) + 2*py*sin(fi)*sin(ka) + 2*pz*cos(fi))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx) - 1.0/2.0*(2*px*sin(om)*cos(fi)*cos(ka) - 2*py*sin(ka)*sin(om)*cos(fi) + 2*pz*sin(fi)*sin(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(-2*px*cos(fi)*cos(ka)*cos(om) + 2*py*sin(ka)*cos(fi)*cos(om) - 2*pz*sin(fi)*cos(om))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + (-px*sin(fi)*cos(ka) + py*sin(fi)*sin(ka) + pz*cos(fi))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))))/pi;
j.coeffRef(0,5) = -0.5*cols*(-((px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(2*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(2*px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - 1.0/2.0*(-2*px*sin(ka)*cos(fi) - 2*py*cos(fi)*cos(ka))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) + ((-px*sin(ka)*cos(fi) - py*cos(fi)*cos(ka))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(2*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(2*px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - 1.0/2.0*(-2*px*sin(ka)*cos(fi) - 2*py*cos(fi)*cos(ka))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))))/pi;
j.coeffRef(0,6) = -0.5*cols*(-((-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*cos(fi)*cos(ka))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) + ((-1.0/2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*cos(fi)*cos(ka))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + cos(fi)*cos(ka)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))))/pi;
j.coeffRef(0,7) = -0.5*cols*(-((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) + (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*sin(ka)*cos(fi))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) + ((-1.0/2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) + (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*sin(ka)*cos(fi))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) - sin(ka)*cos(fi)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))))/pi;
j.coeffRef(0,8) = -0.5*cols*(-(((px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)*sin(om)*cos(fi) - (px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)*cos(fi)*cos(om) - (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*sin(fi))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + cos(fi)*cos(om)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))) + (((px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)*sin(om)*cos(fi) - (px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)*cos(fi)*cos(om) - (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*sin(fi))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + sin(fi)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)/((pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))))/pi;
j.coeffRef(1,0) = -rows*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)*(-px*cos(fi)*cos(ka) + py*sin(ka)*cos(fi) - pz*sin(fi) - tx)/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0));
j.coeffRef(1,1) = -rows*(pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), -1.0/2.0) + (-px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + pz*sin(om)*cos(fi) - ty)*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
j.coeffRef(1,2) = -rows*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*cos(fi)*cos(om) - tz)/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))*pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0));
j.coeffRef(1,3) = -rows*((-1.0/2.0*(2*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*pz*sin(om)*cos(fi))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - 1.0/2.0*(2*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*pz*cos(fi)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + (px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - pz*cos(fi)*cos(om))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
j.coeffRef(1,4) = -rows*((-1.0/2.0*(-2*px*sin(fi)*cos(ka) + 2*py*sin(fi)*sin(ka) + 2*pz*cos(fi))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx) - 1.0/2.0*(2*px*sin(om)*cos(fi)*cos(ka) - 2*py*sin(ka)*sin(om)*cos(fi) + 2*pz*sin(fi)*sin(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(-2*px*cos(fi)*cos(ka)*cos(om) + 2*py*sin(ka)*cos(fi)*cos(om) - 2*pz*sin(fi)*cos(om))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) + (px*sin(om)*cos(fi)*cos(ka) - py*sin(ka)*sin(om)*cos(fi) + pz*sin(fi)*sin(om))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
j.coeffRef(1,5) = -rows*((px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(2*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(2*px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - 1.0/2.0*(-2*px*sin(ka)*cos(fi) - 2*py*cos(fi)*cos(ka))*(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
j.coeffRef(1,6) = -rows*((sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) - (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*cos(fi)*cos(ka))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
j.coeffRef(1,7) = -rows*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)) + (-1.0/2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty) - 1.0/2.0*(2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz) + (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*sin(ka)*cos(fi))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
j.coeffRef(1,8) = -rows*(((px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)*sin(om)*cos(fi) - (px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz)*cos(fi)*cos(om) - (px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx)*sin(fi))*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty)/pow(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2), 3.0/2.0) - sin(om)*cos(fi)/sqrt(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2)))/(pi*sqrt(1 - pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2)/(pow(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*sin(om)*cos(fi) + ty, 2) + pow(px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*cos(fi)*cos(om) + tz, 2) + pow(px*cos(fi)*cos(ka) - py*sin(ka)*cos(fi) + pz*sin(fi) + tx, 2))));
}