inline void point_to_point_source_to_landmark_tait_bryan_wc_d2sum_dbeta2(Eigen::Matrix<double, 6, 6, Eigen::RowMajor> &d2sum_dbeta2, double px, double py, double pz, double om, double fi, double ka, double x_s, double y_s, double z_s, double x_L, double y_L, double z_L)
{d2sum_dbeta2.coeffRef(0,0) = 2;
d2sum_dbeta2.coeffRef(0,1) = 0;
d2sum_dbeta2.coeffRef(0,2) = 0;
d2sum_dbeta2.coeffRef(0,3) = 0;
d2sum_dbeta2.coeffRef(0,4) = -2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(fi)*sin(ka) + 2*z_s*cos(fi);
d2sum_dbeta2.coeffRef(0,5) = -2*x_s*sin(ka)*cos(fi) - 2*y_s*cos(fi)*cos(ka);
d2sum_dbeta2.coeffRef(1,0) = 0;
d2sum_dbeta2.coeffRef(1,1) = 2;
d2sum_dbeta2.coeffRef(1,2) = 0;
d2sum_dbeta2.coeffRef(1,3) = 2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*z_s*cos(fi)*cos(om);
d2sum_dbeta2.coeffRef(1,4) = 2*x_s*sin(om)*cos(fi)*cos(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(fi)*sin(om);
d2sum_dbeta2.coeffRef(1,5) = 2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om));
d2sum_dbeta2.coeffRef(2,0) = 0;
d2sum_dbeta2.coeffRef(2,1) = 0;
d2sum_dbeta2.coeffRef(2,2) = 2;
d2sum_dbeta2.coeffRef(2,3) = 2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*z_s*sin(om)*cos(fi);
d2sum_dbeta2.coeffRef(2,4) = -2*x_s*cos(fi)*cos(ka)*cos(om) + 2*y_s*sin(ka)*cos(fi)*cos(om) - 2*z_s*sin(fi)*cos(om);
d2sum_dbeta2.coeffRef(2,5) = 2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om));
d2sum_dbeta2.coeffRef(3,0) = 0;
d2sum_dbeta2.coeffRef(3,1) = 2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*z_s*cos(fi)*cos(om);
d2sum_dbeta2.coeffRef(3,2) = 2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*z_s*sin(om)*cos(fi);
d2sum_dbeta2.coeffRef(3,3) = (-2*x_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - 2*y_s*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - 2*z_s*sin(om)*cos(fi))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi))*(-x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om))*(-x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*cos(fi)*cos(om)) + (-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om));
d2sum_dbeta2.coeffRef(3,4) = (-2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi))*(x_s*cos(fi)*cos(ka)*cos(om) - y_s*sin(ka)*cos(fi)*cos(om) + z_s*sin(fi)*cos(om)) + (-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om))*(-x_s*sin(om)*cos(fi)*cos(ka) + y_s*sin(ka)*sin(om)*cos(fi) - z_s*sin(fi)*sin(om)) + (-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-2*x_s*cos(fi)*cos(ka)*cos(om) + 2*y_s*sin(ka)*cos(fi)*cos(om) - 2*z_s*sin(fi)*cos(om))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi));
d2sum_dbeta2.coeffRef(3,5) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om)) + (-2*x_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*y_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(-2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi));
d2sum_dbeta2.coeffRef(4,0) = -2*x_s*sin(fi)*cos(ka) + 2*y_s*sin(fi)*sin(ka) + 2*z_s*cos(fi);
d2sum_dbeta2.coeffRef(4,1) = 2*x_s*sin(om)*cos(fi)*cos(ka) - 2*y_s*sin(ka)*sin(om)*cos(fi) + 2*z_s*sin(fi)*sin(om);
d2sum_dbeta2.coeffRef(4,2) = -2*x_s*cos(fi)*cos(ka)*cos(om) + 2*y_s*sin(ka)*cos(fi)*cos(om) - 2*z_s*sin(fi)*cos(om);
d2sum_dbeta2.coeffRef(4,3) = (-x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi))*(2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om)) + (-x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*cos(fi)*cos(om))*(-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om)) + (-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-2*x_s*cos(fi)*cos(ka)*cos(om) + 2*y_s*sin(ka)*cos(fi)*cos(om) - 2*z_s*sin(fi)*cos(om))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi));
d2sum_dbeta2.coeffRef(4,4) = (x_s*sin(fi)*cos(ka) - y_s*sin(fi)*sin(ka) - z_s*cos(fi))*(2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(fi)*sin(ka) - 2*z_s*cos(fi)) + (2*x_s*cos(fi)*cos(ka) - 2*y_s*sin(ka)*cos(fi) + 2*z_s*sin(fi))*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi)) + (2*x_s*sin(fi)*sin(om)*cos(ka) - 2*y_s*sin(fi)*sin(ka)*sin(om) - 2*z_s*sin(om)*cos(fi))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*sin(fi)*cos(ka)*cos(om) + 2*y_s*sin(fi)*sin(ka)*cos(om) + 2*z_s*cos(fi)*cos(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om))*(-x_s*sin(om)*cos(fi)*cos(ka) + y_s*sin(ka)*sin(om)*cos(fi) - z_s*sin(fi)*sin(om)) + (x_s*cos(fi)*cos(ka)*cos(om) - y_s*sin(ka)*cos(fi)*cos(om) + z_s*sin(fi)*cos(om))*(2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om));
d2sum_dbeta2.coeffRef(4,5) = (-x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om)) + (-x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om)) + (-2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(fi)*cos(ka))*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi)) + (x_s*sin(ka)*cos(fi) + y_s*cos(fi)*cos(ka))*(2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(fi)*sin(ka) - 2*z_s*cos(fi)) + (2*x_s*sin(ka)*sin(om)*cos(fi) + 2*y_s*sin(om)*cos(fi)*cos(ka))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*sin(ka)*cos(fi)*cos(om) - 2*y_s*cos(fi)*cos(ka)*cos(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om));
d2sum_dbeta2.coeffRef(5,0) = -2*x_s*sin(ka)*cos(fi) - 2*y_s*cos(fi)*cos(ka);
d2sum_dbeta2.coeffRef(5,1) = 2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om));
d2sum_dbeta2.coeffRef(5,2) = 2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om));
d2sum_dbeta2.coeffRef(5,3) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + z_s*cos(fi)*cos(om)) + (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-2*x_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*y_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(-x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi));
d2sum_dbeta2.coeffRef(5,4) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-x_s*sin(om)*cos(fi)*cos(ka) + y_s*sin(ka)*sin(om)*cos(fi) - z_s*sin(fi)*sin(om)) + (-2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(x_s*cos(fi)*cos(ka)*cos(om) - y_s*sin(ka)*cos(fi)*cos(om) + z_s*sin(fi)*cos(om)) + (-2*x_s*sin(fi)*sin(ka) - 2*y_s*sin(fi)*cos(ka))*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi)) + (2*x_s*sin(ka)*cos(fi) + 2*y_s*cos(fi)*cos(ka))*(x_s*sin(fi)*cos(ka) - y_s*sin(fi)*sin(ka) - z_s*cos(fi)) + (2*x_s*sin(ka)*sin(om)*cos(fi) + 2*y_s*sin(om)*cos(fi)*cos(ka))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*sin(ka)*cos(fi)*cos(om) - 2*y_s*cos(fi)*cos(ka)*cos(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om));
d2sum_dbeta2.coeffRef(5,5) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + (-2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(-x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + (-2*x_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) - 2*y_s*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (x_s*sin(ka)*cos(fi) + y_s*cos(fi)*cos(ka))*(2*x_s*sin(ka)*cos(fi) + 2*y_s*cos(fi)*cos(ka)) + (2*x_s*cos(fi)*cos(ka) - 2*y_s*sin(ka)*cos(fi))*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi));
}
inline void point_to_point_source_to_landmark_tait_bryan_wc_d2sum_dbetadx(Eigen::Matrix<double, 6, 6, Eigen::RowMajor> &d2sum_dbetadx, double px, double py, double pz, double om, double fi, double ka, double x_s, double y_s, double z_s, double x_L, double y_L, double z_L)
{d2sum_dbetadx.coeffRef(0,0) = 2*cos(fi)*cos(ka);
d2sum_dbetadx.coeffRef(0,1) = -2*sin(ka)*cos(fi);
d2sum_dbetadx.coeffRef(0,2) = 2*sin(fi);
d2sum_dbetadx.coeffRef(0,3) = -2;
d2sum_dbetadx.coeffRef(0,4) = 0;
d2sum_dbetadx.coeffRef(0,5) = 0;
d2sum_dbetadx.coeffRef(1,0) = 2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om);
d2sum_dbetadx.coeffRef(1,1) = -2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om);
d2sum_dbetadx.coeffRef(1,2) = -2*sin(om)*cos(fi);
d2sum_dbetadx.coeffRef(1,3) = 0;
d2sum_dbetadx.coeffRef(1,4) = -2;
d2sum_dbetadx.coeffRef(1,5) = 0;
d2sum_dbetadx.coeffRef(2,0) = -2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om);
d2sum_dbetadx.coeffRef(2,1) = 2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka);
d2sum_dbetadx.coeffRef(2,2) = 2*cos(fi)*cos(om);
d2sum_dbetadx.coeffRef(2,3) = 0;
d2sum_dbetadx.coeffRef(2,4) = 0;
d2sum_dbetadx.coeffRef(2,5) = -2;
d2sum_dbetadx.coeffRef(3,0) = (-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om)) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(-2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi));
d2sum_dbetadx.coeffRef(3,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om)) + (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi)) + (2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi));
d2sum_dbetadx.coeffRef(3,2) = -(-2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi))*cos(fi)*cos(om) + (-2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om))*sin(om)*cos(fi) + 2*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi))*cos(fi)*cos(om) + 2*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om))*sin(om)*cos(fi);
d2sum_dbetadx.coeffRef(3,3) = 0;
d2sum_dbetadx.coeffRef(3,4) = -2*x_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - 2*y_s*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*z_s*cos(fi)*cos(om);
d2sum_dbetadx.coeffRef(3,5) = -2*x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*z_s*sin(om)*cos(fi);
d2sum_dbetadx.coeffRef(4,0) = (-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om)) + (sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om)) - (2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(fi)*sin(ka) - 2*z_s*cos(fi))*cos(fi)*cos(ka) + 2*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi))*sin(fi)*cos(ka) - 2*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi))*sin(om)*cos(fi)*cos(ka) + 2*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om))*cos(fi)*cos(ka)*cos(om);
d2sum_dbetadx.coeffRef(4,1) = (sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om)) + (-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om)) + (2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(fi)*sin(ka) - 2*z_s*cos(fi))*sin(ka)*cos(fi) - 2*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi))*sin(fi)*sin(ka) + 2*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi))*sin(ka)*sin(om)*cos(fi) - 2*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om))*sin(ka)*cos(fi)*cos(om);
d2sum_dbetadx.coeffRef(4,2) = -(2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(fi)*sin(ka) - 2*z_s*cos(fi))*sin(fi) + (-2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om))*sin(om)*cos(fi) - (2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om))*cos(fi)*cos(om) - 2*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi))*cos(fi) - 2*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi))*sin(fi)*sin(om) + 2*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om))*sin(fi)*cos(om);
d2sum_dbetadx.coeffRef(4,3) = 2*x_s*sin(fi)*cos(ka) - 2*y_s*sin(fi)*sin(ka) - 2*z_s*cos(fi);
d2sum_dbetadx.coeffRef(4,4) = -2*x_s*sin(om)*cos(fi)*cos(ka) + 2*y_s*sin(ka)*sin(om)*cos(fi) - 2*z_s*sin(fi)*sin(om);
d2sum_dbetadx.coeffRef(4,5) = 2*x_s*cos(fi)*cos(ka)*cos(om) - 2*y_s*sin(ka)*cos(fi)*cos(om) + 2*z_s*sin(fi)*cos(om);
d2sum_dbetadx.coeffRef(5,0) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + (-2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - (2*x_s*sin(ka)*cos(fi) + 2*y_s*cos(fi)*cos(ka))*cos(fi)*cos(ka) + (2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + 2*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi))*sin(ka)*cos(fi);
d2sum_dbetadx.coeffRef(5,1) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + (-2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + (2*x_s*sin(ka)*cos(fi) + 2*y_s*cos(fi)*cos(ka))*sin(ka)*cos(fi) + (2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(-py - x_s*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + y_L - y_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + z_s*sin(om)*cos(fi)) + (-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(-pz - x_s*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - y_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + z_L - z_s*cos(fi)*cos(om)) + 2*(-px + x_L - x_s*cos(fi)*cos(ka) + y_s*sin(ka)*cos(fi) - z_s*sin(fi))*cos(fi)*cos(ka);
d2sum_dbetadx.coeffRef(5,2) = (-2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*sin(om)*cos(fi) - (-2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*cos(fi)*cos(om) - (2*x_s*sin(ka)*cos(fi) + 2*y_s*cos(fi)*cos(ka))*sin(fi);
d2sum_dbetadx.coeffRef(5,3) = 2*x_s*sin(ka)*cos(fi) + 2*y_s*cos(fi)*cos(ka);
d2sum_dbetadx.coeffRef(5,4) = -2*x_s*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*y_s*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om));
d2sum_dbetadx.coeffRef(5,5) = -2*x_s*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - 2*y_s*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om));
}
