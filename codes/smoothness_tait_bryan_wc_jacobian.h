inline void smoothness_obs_eq_tait_bryan_wc(Eigen::Matrix<double, 6, 1> &delta, double px_1, double py_1, double pz_1, double om_1, double fi_1, double ka_1, double px_2, double py_2, double pz_2, double om_2, double fi_2, double ka_2, double px_3, double py_3, double pz_3, double om_3, double fi_3, double ka_3)
{delta.coeffRef(0,0) = px_1*cos(fi_1)*cos(ka_1) - px_2*cos(fi_1)*cos(ka_1) - px_2*cos(fi_2)*cos(ka_2) + px_3*cos(fi_2)*cos(ka_2) - py_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - py_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) + py_2*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + py_3*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) - pz_1*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - pz_2*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) + pz_2*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + pz_3*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2));
delta.coeffRef(1,0) = -px_1*sin(ka_1)*cos(fi_1) + px_2*sin(ka_1)*cos(fi_1) + px_2*sin(ka_2)*cos(fi_2) - px_3*sin(ka_2)*cos(fi_2) - py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - py_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) + py_2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + py_3*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - pz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) + pz_2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + pz_3*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2));
delta.coeffRef(2,0) = px_1*sin(fi_1) - px_2*sin(fi_1) - px_2*sin(fi_2) + px_3*sin(fi_2) - py_1*sin(om_1)*cos(fi_1) + py_2*sin(om_1)*cos(fi_1) + py_2*sin(om_2)*cos(fi_2) - py_3*sin(om_2)*cos(fi_2) + pz_1*cos(fi_1)*cos(om_1) - pz_2*cos(fi_1)*cos(om_1) - pz_2*cos(fi_2)*cos(om_2) + pz_3*cos(fi_2)*cos(om_2);
delta.coeffRef(3,0) = -atan2((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2)) + atan2((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3));
delta.coeffRef(4,0) = -asin(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1)) + asin(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2));
delta.coeffRef(5,0) = -atan2(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), (sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2)) + atan2(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), (sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3));
}
inline void smoothness_obs_eq_tait_bryan_wc_jacobian(Eigen::Matrix<double, 6, 18, Eigen::RowMajor> &j, double px_1, double py_1, double pz_1, double om_1, double fi_1, double ka_1, double px_2, double py_2, double pz_2, double om_2, double fi_2, double ka_2, double px_3, double py_3, double pz_3, double om_3, double fi_3, double ka_3)
{j.coeffRef(0,0) = cos(fi_1)*cos(ka_1);
j.coeffRef(0,1) = sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1);
j.coeffRef(0,2) = -sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1);
j.coeffRef(0,3) = -py_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - py_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1)) - pz_1*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - pz_2*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1));
j.coeffRef(0,4) = -px_1*sin(fi_1)*cos(ka_1) + px_2*sin(fi_1)*cos(ka_1) + py_1*sin(om_1)*cos(fi_1)*cos(ka_1) - py_2*sin(om_1)*cos(fi_1)*cos(ka_1) - pz_1*cos(fi_1)*cos(ka_1)*cos(om_1) + pz_2*cos(fi_1)*cos(ka_1)*cos(om_1);
j.coeffRef(0,5) = -px_1*sin(ka_1)*cos(fi_1) + px_2*sin(ka_1)*cos(fi_1) - py_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - py_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1)) - pz_1*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - pz_2*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1));
j.coeffRef(0,6) = -cos(fi_1)*cos(ka_1) - cos(fi_2)*cos(ka_2);
j.coeffRef(0,7) = -sin(fi_1)*sin(om_1)*cos(ka_1) - sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_1)*cos(om_1) - sin(ka_2)*cos(om_2);
j.coeffRef(0,8) = sin(fi_1)*cos(ka_1)*cos(om_1) + sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_1)*sin(om_1) - sin(ka_2)*sin(om_2);
j.coeffRef(0,9) = py_2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + py_3*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + pz_2*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + pz_3*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2));
j.coeffRef(0,10) = px_2*sin(fi_2)*cos(ka_2) - px_3*sin(fi_2)*cos(ka_2) - py_2*sin(om_2)*cos(fi_2)*cos(ka_2) + py_3*sin(om_2)*cos(fi_2)*cos(ka_2) + pz_2*cos(fi_2)*cos(ka_2)*cos(om_2) - pz_3*cos(fi_2)*cos(ka_2)*cos(om_2);
j.coeffRef(0,11) = px_2*sin(ka_2)*cos(fi_2) - px_3*sin(ka_2)*cos(fi_2) + py_2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + py_3*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + pz_2*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + pz_3*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2));
j.coeffRef(0,12) = cos(fi_2)*cos(ka_2);
j.coeffRef(0,13) = sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2);
j.coeffRef(0,14) = -sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2);
j.coeffRef(0,15) = 0;
j.coeffRef(0,16) = 0;
j.coeffRef(0,17) = 0;
j.coeffRef(1,0) = -sin(ka_1)*cos(fi_1);
j.coeffRef(1,1) = -sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1);
j.coeffRef(1,2) = sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1);
j.coeffRef(1,3) = -py_1*(sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1)) - py_2*(-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1)) - pz_1*(sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1)) - pz_2*(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1));
j.coeffRef(1,4) = px_1*sin(fi_1)*sin(ka_1) - px_2*sin(fi_1)*sin(ka_1) - py_1*sin(ka_1)*sin(om_1)*cos(fi_1) + py_2*sin(ka_1)*sin(om_1)*cos(fi_1) + pz_1*sin(ka_1)*cos(fi_1)*cos(om_1) - pz_2*sin(ka_1)*cos(fi_1)*cos(om_1);
j.coeffRef(1,5) = -px_1*cos(fi_1)*cos(ka_1) + px_2*cos(fi_1)*cos(ka_1) - py_1*(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1)) - py_2*(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1)) - pz_1*(-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1)) - pz_2*(sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1));
j.coeffRef(1,6) = sin(ka_1)*cos(fi_1) + sin(ka_2)*cos(fi_2);
j.coeffRef(1,7) = sin(fi_1)*sin(ka_1)*sin(om_1) + sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_1)*cos(om_1) - cos(ka_2)*cos(om_2);
j.coeffRef(1,8) = -sin(fi_1)*sin(ka_1)*cos(om_1) - sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_1)*cos(ka_1) - sin(om_2)*cos(ka_2);
j.coeffRef(1,9) = py_2*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + py_3*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + pz_2*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + pz_3*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2));
j.coeffRef(1,10) = -px_2*sin(fi_2)*sin(ka_2) + px_3*sin(fi_2)*sin(ka_2) + py_2*sin(ka_2)*sin(om_2)*cos(fi_2) - py_3*sin(ka_2)*sin(om_2)*cos(fi_2) - pz_2*sin(ka_2)*cos(fi_2)*cos(om_2) + pz_3*sin(ka_2)*cos(fi_2)*cos(om_2);
j.coeffRef(1,11) = px_2*cos(fi_2)*cos(ka_2) - px_3*cos(fi_2)*cos(ka_2) + py_2*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + py_3*(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2)) + pz_2*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + pz_3*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2));
j.coeffRef(1,12) = -sin(ka_2)*cos(fi_2);
j.coeffRef(1,13) = -sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2);
j.coeffRef(1,14) = sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2);
j.coeffRef(1,15) = 0;
j.coeffRef(1,16) = 0;
j.coeffRef(1,17) = 0;
j.coeffRef(2,0) = sin(fi_1);
j.coeffRef(2,1) = -sin(om_1)*cos(fi_1);
j.coeffRef(2,2) = cos(fi_1)*cos(om_1);
j.coeffRef(2,3) = -py_1*cos(fi_1)*cos(om_1) + py_2*cos(fi_1)*cos(om_1) - pz_1*sin(om_1)*cos(fi_1) + pz_2*sin(om_1)*cos(fi_1);
j.coeffRef(2,4) = px_1*cos(fi_1) - px_2*cos(fi_1) + py_1*sin(fi_1)*sin(om_1) - py_2*sin(fi_1)*sin(om_1) - pz_1*sin(fi_1)*cos(om_1) + pz_2*sin(fi_1)*cos(om_1);
j.coeffRef(2,5) = 0;
j.coeffRef(2,6) = -sin(fi_1) - sin(fi_2);
j.coeffRef(2,7) = sin(om_1)*cos(fi_1) + sin(om_2)*cos(fi_2);
j.coeffRef(2,8) = -cos(fi_1)*cos(om_1) - cos(fi_2)*cos(om_2);
j.coeffRef(2,9) = py_2*cos(fi_2)*cos(om_2) - py_3*cos(fi_2)*cos(om_2) + pz_2*sin(om_2)*cos(fi_2) - pz_3*sin(om_2)*cos(fi_2);
j.coeffRef(2,10) = -px_2*cos(fi_2) + px_3*cos(fi_2) - py_2*sin(fi_2)*sin(om_2) + py_3*sin(fi_2)*sin(om_2) + pz_2*sin(fi_2)*cos(om_2) - pz_3*sin(fi_2)*cos(om_2);
j.coeffRef(2,11) = 0;
j.coeffRef(2,12) = sin(fi_2);
j.coeffRef(2,13) = -sin(om_2)*cos(fi_2);
j.coeffRef(2,14) = cos(fi_2)*cos(om_2);
j.coeffRef(2,15) = 0;
j.coeffRef(2,16) = 0;
j.coeffRef(2,17) = 0;
j.coeffRef(3,0) = 0;
j.coeffRef(3,1) = 0;
j.coeffRef(3,2) = 0;
j.coeffRef(3,3) = -((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) + sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,4) = -(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-sin(fi_1)*sin(fi_2)*sin(ka_1) - sin(ka_1)*sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))*(-sin(fi_1)*sin(om_1)*sin(om_2)*cos(fi_2) - sin(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2) + sin(fi_2)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,5) = -(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,6) = 0;
j.coeffRef(3,7) = 0;
j.coeffRef(3,8) = 0;
j.coeffRef(3,9) = -((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(om_2)*cos(fi_2))*(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + ((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*cos(fi_3)*cos(om_3) + (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*sin(om_3)*cos(fi_3))*(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2)) - (sin(om_1)*cos(fi_1)*cos(fi_2)*cos(om_2) - sin(om_2)*cos(fi_1)*cos(fi_2)*cos(om_1))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) + (-sin(om_2)*cos(fi_2)*cos(fi_3)*cos(om_3) + sin(om_3)*cos(fi_2)*cos(fi_3)*cos(om_2))*(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) - sin(fi_3)*sin(ka_2)*cos(fi_2))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2));
j.coeffRef(3,10) = (sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3))*(-sin(fi_2)*sin(fi_3)*sin(ka_2) - sin(ka_2)*sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) - sin(ka_2)*cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2)) + (-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) - sin(fi_3)*sin(ka_2)*cos(fi_2))*(-sin(fi_2)*sin(om_2)*sin(om_3)*cos(fi_3) - sin(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3) + sin(fi_3)*cos(fi_2))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2)) - (sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*sin(ka_1)*cos(om_1) - sin(om_1)*cos(ka_1))*sin(fi_2)*cos(om_2) + sin(ka_1)*cos(fi_1)*cos(fi_2))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2)) - (sin(fi_1)*cos(fi_2) - sin(fi_2)*sin(om_1)*sin(om_2)*cos(fi_1) - sin(fi_2)*cos(fi_1)*cos(om_1)*cos(om_2))*(-(-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/(pow(sin(fi_1)*sin(fi_2) + sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2) + cos(fi_1)*cos(fi_2)*cos(om_1)*cos(om_2), 2) + pow((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) - (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*sin(ka_1)*cos(fi_1), 2));
j.coeffRef(3,11) = (sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3))*((-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2));
j.coeffRef(3,12) = 0;
j.coeffRef(3,13) = 0;
j.coeffRef(3,14) = 0;
j.coeffRef(3,15) = ((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*cos(fi_3)*cos(om_3) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*sin(om_3)*cos(fi_3))*(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2)) + (sin(om_2)*cos(fi_2)*cos(fi_3)*cos(om_3) - sin(om_3)*cos(fi_2)*cos(fi_3)*cos(om_2))*(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) - sin(fi_3)*sin(ka_2)*cos(fi_2))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2));
j.coeffRef(3,16) = (sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3))*(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(fi_3)*sin(om_3) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*sin(fi_3)*cos(om_3) + sin(ka_2)*cos(fi_2)*cos(fi_3))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2)) + (sin(fi_2)*cos(fi_3) - sin(fi_3)*sin(om_2)*sin(om_3)*cos(fi_2) - sin(fi_3)*cos(fi_2)*cos(om_2)*cos(om_3))*(-(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) - sin(fi_3)*sin(ka_2)*cos(fi_2))/(pow(sin(fi_2)*sin(fi_3) + sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3) + cos(fi_2)*cos(fi_3)*cos(om_2)*cos(om_3), 2) + pow((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) - (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*sin(ka_2)*cos(fi_2), 2));
j.coeffRef(3,17) = 0;
j.coeffRef(4,0) = 0;
j.coeffRef(4,1) = 0;
j.coeffRef(4,2) = 0;
j.coeffRef(4,3) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,4) = -(-sin(fi_1)*sin(fi_2)*cos(ka_1) - sin(om_1)*sin(om_2)*cos(fi_1)*cos(fi_2)*cos(ka_1) - cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(om_1)*cos(om_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,5) = -((sin(fi_1)*sin(ka_1)*sin(om_1) - cos(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_1)*cos(fi_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,6) = 0;
j.coeffRef(4,7) = 0;
j.coeffRef(4,8) = 0;
j.coeffRef(4,9) = ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*cos(fi_3)*cos(om_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*sin(om_3)*cos(fi_3))/sqrt(1 - pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*cos(fi_2)*cos(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(om_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,10) = (-sin(fi_2)*sin(fi_3)*cos(ka_2) - sin(om_2)*sin(om_3)*cos(fi_2)*cos(fi_3)*cos(ka_2) - cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(om_2)*cos(om_3))/sqrt(1 - pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2), 2)) - (-(-sin(fi_1)*sin(om_1)*cos(ka_1) - sin(ka_1)*cos(om_1))*sin(fi_2)*sin(om_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(fi_2)*cos(om_2) + cos(fi_1)*cos(fi_2)*cos(ka_1))/sqrt(1 - pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(om_2) + sin(fi_2)*cos(fi_1)*cos(ka_1), 2));
j.coeffRef(4,11) = ((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*cos(fi_3)*cos(om_3) - sin(fi_3)*sin(ka_2)*cos(fi_2))/sqrt(1 - pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(4,12) = 0;
j.coeffRef(4,13) = 0;
j.coeffRef(4,14) = 0;
j.coeffRef(4,15) = ((-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2))*cos(fi_3)*cos(om_3) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*sin(om_3)*cos(fi_3))/sqrt(1 - pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(4,16) = (-(-sin(fi_2)*sin(om_2)*cos(ka_2) - sin(ka_2)*cos(om_2))*sin(fi_3)*sin(om_3) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*sin(fi_3)*cos(om_3) + cos(fi_2)*cos(fi_3)*cos(ka_2))/sqrt(1 - pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(om_3) + sin(fi_3)*cos(fi_2)*cos(ka_2), 2));
j.coeffRef(4,17) = 0;
j.coeffRef(5,0) = 0;
j.coeffRef(5,1) = 0;
j.coeffRef(5,2) = 0;
j.coeffRef(5,3) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + (sin(fi_1)*cos(ka_1)*cos(om_1) - sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,4) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2))*sin(om_1)*cos(fi_1)*cos(ka_1) - (-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2))*cos(fi_1)*cos(ka_1)*cos(om_1) - sin(fi_1)*sin(ka_2)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,5) = -((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*sin(ka_2)*cos(om_2) - sin(om_2)*cos(ka_2)) - sin(ka_1)*sin(ka_2)*cos(fi_1)*cos(fi_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((-sin(fi_1)*sin(ka_1)*sin(om_1) + cos(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (sin(fi_1)*sin(ka_1)*cos(om_1) + sin(om_1)*cos(ka_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) - sin(ka_1)*cos(fi_1)*cos(fi_2)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,6) = 0;
j.coeffRef(5,7) = 0;
j.coeffRef(5,8) = 0;
j.coeffRef(5,9) = -((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*sin(om_2) - cos(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) + ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*cos(om_3) - sin(om_3)*cos(ka_3)) + (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*sin(om_3) - cos(ka_3)*cos(om_3)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) + ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + (sin(fi_2)*cos(ka_2)*cos(om_2) - sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) - sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2));
j.coeffRef(5,10) = ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) - sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2))*((sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) + ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3))*((sin(fi_3)*sin(ka_3)*sin(om_3) - cos(ka_3)*cos(om_3))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_3)*sin(ka_3)*cos(om_3) - sin(om_3)*cos(ka_3))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*sin(ka_3)*cos(fi_3)*cos(ka_2))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(om_2)*cos(fi_2)*cos(ka_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*cos(fi_2)*cos(ka_2)*cos(om_2) - sin(fi_2)*cos(fi_1)*cos(ka_1)*cos(ka_2))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - ((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2))*((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*sin(ka_2)*sin(om_2)*cos(fi_2) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*sin(ka_2)*cos(fi_2)*cos(om_2) - sin(fi_2)*sin(ka_2)*cos(fi_1)*cos(ka_1))/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,11) = ((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*(sin(fi_3)*sin(ka_3)*sin(om_3) - cos(ka_3)*cos(om_3)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*(-sin(fi_3)*sin(ka_3)*cos(om_3) - sin(om_3)*cos(ka_3)) - sin(ka_2)*sin(ka_3)*cos(fi_2)*cos(fi_3))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) + ((-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) - sin(ka_2)*cos(fi_2)*cos(fi_3)*cos(ka_3))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) - sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) - sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)) - pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2)/(pow(-(sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(-sin(fi_2)*sin(ka_2)*sin(om_2) + cos(ka_2)*cos(om_2)) - (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(sin(fi_2)*sin(ka_2)*cos(om_2) + sin(om_2)*cos(ka_2)) + sin(ka_2)*cos(fi_1)*cos(fi_2)*cos(ka_1), 2) + pow((sin(fi_1)*sin(om_1)*cos(ka_1) + sin(ka_1)*cos(om_1))*(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2)) + (-sin(fi_1)*cos(ka_1)*cos(om_1) + sin(ka_1)*sin(om_1))*(-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2)) + cos(fi_1)*cos(fi_2)*cos(ka_1)*cos(ka_2), 2));
j.coeffRef(5,12) = 0;
j.coeffRef(5,13) = 0;
j.coeffRef(5,14) = 0;
j.coeffRef(5,15) = ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*sin(om_3) - cos(ka_3)*cos(om_3)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) + ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*cos(ka_3)*cos(om_3) - sin(ka_3)*sin(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) - sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2));
j.coeffRef(5,16) = ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) - sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(om_3)*cos(fi_3)*cos(ka_3) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*cos(fi_3)*cos(ka_3)*cos(om_3) - sin(fi_3)*cos(fi_2)*cos(ka_2)*cos(ka_3))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) + ((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3))*((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*sin(ka_3)*sin(om_3)*cos(fi_3) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*sin(ka_3)*cos(fi_3)*cos(om_3) - sin(fi_3)*sin(ka_3)*cos(fi_2)*cos(ka_2))/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2));
j.coeffRef(5,17) = pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) - sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2)/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2)/(pow(-(sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(-sin(fi_3)*sin(ka_3)*sin(om_3) + cos(ka_3)*cos(om_3)) - (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(sin(fi_3)*sin(ka_3)*cos(om_3) + sin(om_3)*cos(ka_3)) + sin(ka_3)*cos(fi_2)*cos(fi_3)*cos(ka_2), 2) + pow((sin(fi_2)*sin(om_2)*cos(ka_2) + sin(ka_2)*cos(om_2))*(sin(fi_3)*sin(om_3)*cos(ka_3) + sin(ka_3)*cos(om_3)) + (-sin(fi_2)*cos(ka_2)*cos(om_2) + sin(ka_2)*sin(om_2))*(-sin(fi_3)*cos(ka_3)*cos(om_3) + sin(ka_3)*sin(om_3)) + cos(fi_2)*cos(fi_3)*cos(ka_2)*cos(ka_3), 2));
}