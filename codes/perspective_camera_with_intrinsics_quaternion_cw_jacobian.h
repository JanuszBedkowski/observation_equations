inline void observation_equation_perspective_camera_with_intrinsics_quaternion_cw(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double px, double py, double pz, double q0, double q1, double q2, double q3, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp, double k1, double k2, double k3, double p1, double p2)
{delta.coeffRef(0,0) = -cx - fx*(2.0*p1*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))) + u_kp;
delta.coeffRef(1,0) = -cy - fy*(p1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1))) + v_kp;
}inline void projection_perspective_camera_with_intrinsics_quaternion_cw(double &u, double &v, double fx, double fy, double cx, double cy, double px, double py, double pz, double q0, double q1, double q2, double q3, double tie_px, double tie_py, double tie_pz, double k1, double k2, double k3, double p1, double p2)
{u = cx + fx*(2.0*p1*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
v = cy + fy*(p1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
}
inline void observation_equation_perspective_camera_with_intrinsics_quaternion_cw_jacobian(Eigen::Matrix<double, 2, 15> &j, double fx, double fy, double px, double py, double pz, double q0, double q1, double q2, double q3, double tie_px, double tie_py, double tie_pz, double k1, double k2, double k3, double p1, double p2)
{j.coeffRef(0,0) = -1.0*fx*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1));
j.coeffRef(0,1) = -1.0*fx*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1));
j.coeffRef(0,2) = -1.0*fx*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1));
j.coeffRef(0,3) = -2.0*fx*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2);
j.coeffRef(0,4) = -fx*(3.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2));
j.coeffRef(0,5) = -fx*(2.0*p1*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(6.0*px + 6.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 6.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 6.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2*k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3*k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,6) = -fx*(2.0*p1*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2*k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3*k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,7) = -fx*(-4.0*p1*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + p2*(-6.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 2.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + 1.0*(k1*(-2.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 2.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + k2*(-4.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 4.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3))*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*(-6.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 6.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3))*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2));
j.coeffRef(0,8) = -fx*(2.0*p1*(-4.0*q1*tie_py + 4.0*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p1*(-2.0*q1*tie_pz + 2.0*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(2.0*q2*tie_pz - 2.0*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(-2.0*q1*tie_py + 2.0*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(2.0*q2*tie_pz - 2.0*q3*tie_py)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,9) = -fx*(2.0*p1*(2.0*q2*tie_py + 2.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p1*(-2.0*q0*tie_pz - 4*q1*tie_py + 2.0*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(2.0*q2*tie_py + 2.0*q3*tie_pz)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(-2.0*q0*tie_py + 4*q1*tie_pz - 2.0*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2));
j.coeffRef(0,10) = -fx*(2.0*p1*(2.0*q1*tie_px + 2.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p1*(2.0*q0*tie_pz + 2.0*q1*tie_py - 4*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(1.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(k1*(1.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(2.0*q0*tie_px + 4*q2*tie_pz - 2.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(2.0*q0*tie_pz + 2.0*q1*tie_py - 4*q2*tie_px)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,11) = -fx*(2.0*p1*(-4.0*q1*tie_px - 4.0*q2*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p1*(2.0*q0*tie_px + 2.0*q2*tie_pz - 4*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(-2.0*q0*tie_py + 2.0*q1*tie_pz - 4*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(-2.0*q1*tie_px - 2.0*q2*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(1.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(-2.0*q0*tie_py + 2.0*q1*tie_pz - 4*q3*tie_px)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,12) = -fx*(2.0*p1*(4.0*q0*q2 - 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p1*(2.0*q0*q3 + 2.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(2.0*q0*q2 - 2.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,13) = -fx*(2.0*p1*(-4.0*q0*q1 - 4.0*q2*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p1*(-2.0*q0*q3 + 2.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + p2*(3.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 1.0*(-2.0*q0*q1 - 2.0*q2*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2.0*q0*q3 + 2.0*q1*q2)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(0,14) = -fx*(2.0*p1*(-2.0*q0*q1 + 2.0*q2*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(2.0*q0*q2 + 2.0*q1*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p1*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + p2*(1.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + 1.0*(2.0*q0*q2 + 2.0*q1*q3)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(2*pow(q1, 2) + 2*pow(q2, 2) - 1)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(1.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)))*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,0) = -1.0*fy*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1));
j.coeffRef(1,1) = -1.0*fy*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1));
j.coeffRef(1,2) = -1.0*fy*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1));
j.coeffRef(1,3) = -fy*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2));
j.coeffRef(1,4) = -2.0*fy*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2);
j.coeffRef(1,5) = -fy*(p1*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2*k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3*k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(2.0*px + 2.0*tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,6) = -fy*(p1*(6.0*py + 6.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 6.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 6.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2*k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3*k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(2.0*py + 2.0*tie_px*(2.0*q0*q3 + 2.0*q1*q2) + 2.0*tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + 2.0*tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,7) = -fy*(p1*(-2.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 6.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) - 4.0*p2*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(k1*(-2.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 2.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + k2*(-4.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 4.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3))*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*(-6.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) - 6.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3))*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) - 1.0*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2));
j.coeffRef(1,8) = -fy*(p1*(1.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(-4.0*q1*tie_py + 4.0*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p2*(-2.0*q1*tie_pz + 2.0*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(2.0*q2*tie_pz - 2.0*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2.0*q1*tie_py + 2.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2.0*q1*tie_pz + 2.0*q3*tie_px)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_py + 4.0*q2*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_pz + 4.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,9) = -fy*(p1*(1.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(2.0*q2*tie_py + 2.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p2*(-2.0*q0*tie_pz - 4*q1*tie_py + 2.0*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(1.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(4.0*q2*tie_py + 4.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*tie_py + 8*q1*tie_pz - 4.0*q3*tie_px)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*tie_pz - 8*q1*tie_py + 4.0*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(-2.0*q0*tie_py + 4*q1*tie_pz - 2.0*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2.0*q0*tie_pz - 4*q1*tie_py + 2.0*q2*tie_px)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,10) = -fy*(p1*(3.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(2.0*q1*tie_px + 2.0*q3*tie_pz)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p2*(2.0*q0*tie_pz + 2.0*q1*tie_py - 4*q2*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(2.0*q1*tie_px + 2.0*q3*tie_pz)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(4.0*q1*tie_px + 4.0*q3*tie_pz)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_px + 8*q2*tie_pz - 4.0*q3*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_pz + 4.0*q1*tie_py - 8*q2*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(2.0*q0*tie_px + 4*q2*tie_pz - 2.0*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2));
j.coeffRef(1,11) = -fy*(p1*(1.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(-4.0*q1*tie_px - 4.0*q2*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p2*(2.0*q0*tie_px + 2.0*q2*tie_pz - 4*q3*tie_py)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(-2.0*q0*tie_py + 2.0*q1*tie_pz - 4*q3*tie_px)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2.0*q1*tie_px - 2.0*q2*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(1.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q1*tie_px - 4.0*q2*tie_py)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*tie_px + 4.0*q2*tie_pz - 8*q3*tie_py)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4.0*q0*tie_py + 4.0*q1*tie_pz - 8*q3*tie_px)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(2.0*q0*tie_px + 2.0*q2*tie_pz - 4*q3*tie_py)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,12) = -fy*(p1*(1.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(4.0*q0*q2 - 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p2*(2.0*q0*q3 + 2.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(2.0*q0*q2 - 2.0*q1*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(2.0*q0*q3 + 2.0*q1*q2)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*q2 - 4.0*q1*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4.0*q0*q3 + 4.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4*pow(q2, 2) - 4*pow(q3, 2) + 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,13) = -fy*(p1*(1.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + 2.0*p2*(-4.0*q0*q1 - 4.0*q2*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*p2*(-2.0*q0*q3 + 2.0*q1*q2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2.0*q0*q1 - 2.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(k1*(1.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*q1 - 4.0*q2*q3)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(-4.0*q0*q3 + 4.0*q1*q2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(-4*pow(q1, 2) - 4*pow(q3, 2) + 2)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
j.coeffRef(1,14) = -fy*(p1*(3.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + 2.0*p2*(-2.0*q0*q1 + 2.0*q2*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(2.0*q0*q2 + 2.0*q1*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*p2*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(-2.0*q0*q1 + 2.0*q2*q3)*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)) + 1.0*(2*pow(q1, 2) + 2*pow(q2, 2) - 1)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))*(k1*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2)) + k2*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 3) + 1)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(k1*(1.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 1.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + k2*(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2))*(2.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 2.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 2.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)) + k3*pow(1.0*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 1.0*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2), 2)*(3.0*(-4.0*q0*q1 + 4.0*q2*q3)*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4.0*q0*q2 + 4.0*q1*q3)*(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3))/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 2) + 3.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(px + tie_px*(-2*pow(q2, 2) - 2*pow(q3, 2) + 1) + tie_py*(-2.0*q0*q3 + 2.0*q1*q2) + tie_pz*(2.0*q0*q2 + 2.0*q1*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3) + 3.0*(4*pow(q1, 2) + 4*pow(q2, 2) - 2)*pow(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3), 2)/pow(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1), 3)))*(py + tie_px*(2.0*q0*q3 + 2.0*q1*q2) + tie_py*(-2*pow(q1, 2) - 2*pow(q3, 2) + 1) + tie_pz*(-2.0*q0*q1 + 2.0*q2*q3))/(pz + tie_px*(-2.0*q0*q2 + 2.0*q1*q3) + tie_py*(2.0*q0*q1 + 2.0*q2*q3) + tie_pz*(-2*pow(q1, 2) - 2*pow(q2, 2) + 1)));
}