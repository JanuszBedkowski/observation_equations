inline void equrectangular_camera_colinearity_tait_bryan_wc(double &u, double &v, double rows, double cols, double pi, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz)
{u = cols*(0.5 + 0.5*atan2((px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)), (pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/pi);
v = rows*(0.5 + asin((py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/pi);
}
inline void observation_equation_equrectangular_camera_colinearity_tait_bryan_wc(Eigen::Matrix<double, 2, 1> &delta, double rows, double cols, double pi, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp)
{delta.coeffRef(0,0) = -cols*(0.5 + 0.5*atan2((px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)), (pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/pi) + u_kp;
delta.coeffRef(1,0) = -rows*(0.5 + asin((py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/pi) + v_kp;
}
inline void observation_equation_equrectangular_camera_colinearity_tait_bryan_wc_jacobian(Eigen::Matrix<double, 2, 9, Eigen::RowMajor> &j, double rows, double cols, double pi, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp)
{j.coeffRef(0,0) = -0.5*cols*((pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), -1.0/2.0) + (-px - tie_px*cos(fi)*cos(ka) + tie_py*sin(ka)*cos(fi) - tie_pz*sin(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) - (-px - tie_px*cos(fi)*cos(ka) + tie_py*sin(ka)*cos(fi) - tie_pz*sin(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)))/pi;
j.coeffRef(0,1) = 0;
j.coeffRef(0,2) = -0.5*cols*(-(pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), -1.0/2.0) + (-pz - tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) + (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(-pz - tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)))/pi;
j.coeffRef(0,3) = -0.5*cols*((-1.0/2.0*(2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*tie_pz*sin(om)*cos(fi))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0/2.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 2)) - ((-1.0/2.0*(2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*tie_pz*sin(om)*cos(fi))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0/2.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + (tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))))/pi;
j.coeffRef(0,4) = -0.5*cols*(((-1.0/2.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi)) - 1.0/2.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(-2*tie_px*cos(fi)*cos(ka)*cos(om) + 2*tie_py*sin(ka)*cos(fi)*cos(om) - 2*tie_pz*sin(fi)*cos(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + (-tie_px*sin(fi)*cos(ka) + tie_py*sin(fi)*sin(ka) + tie_pz*cos(fi))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) - ((-1.0/2.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi)) - 1.0/2.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(-2*tie_px*cos(fi)*cos(ka)*cos(om) + 2*tie_py*sin(ka)*cos(fi)*cos(om) - 2*tie_pz*sin(fi)*cos(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + (-tie_px*cos(fi)*cos(ka)*cos(om) + tie_py*sin(ka)*cos(fi)*cos(om) - tie_pz*sin(fi)*cos(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))))/pi;
j.coeffRef(0,5) = -0.5*cols*(-((tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0/2.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) + ((-tie_px*sin(ka)*cos(fi) - tie_py*cos(fi)*cos(ka))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0/2.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))))/pi;
j.coeffRef(0,6) = -0.5*cols*(-((-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) + ((-1.0/2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + cos(fi)*cos(ka)/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))))/pi;
j.coeffRef(0,7) = -0.5*cols*(-((sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) + ((-1.0/2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) - sin(ka)*cos(fi)/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))))/pi;
j.coeffRef(0,8) = -0.5*cols*(((-(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi) + (py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi) - (pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))*cos(fi)*cos(om))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + sin(fi)/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))) - ((-(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi) + (py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi) - (pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))*cos(fi)*cos(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + cos(fi)*cos(om)/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))/((pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))))/pi;
j.coeffRef(1,0) = -rows*(-px - tie_px*cos(fi)*cos(ka) + tie_py*sin(ka)*cos(fi) - tie_pz*sin(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0));
j.coeffRef(1,1) = -rows*(pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), -1.0/2.0) + (-py - tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*sin(om)*cos(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
j.coeffRef(1,2) = -rows*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*(-pz - tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))*pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0));
j.coeffRef(1,3) = -rows*((-1.0/2.0*(2*tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - 2*tie_pz*sin(om)*cos(fi))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0/2.0*(2*tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_pz*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + (tie_px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_pz*cos(fi)*cos(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
j.coeffRef(1,4) = -rows*((-1.0/2.0*(-2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(fi)*sin(ka) + 2*tie_pz*cos(fi))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi)) - 1.0/2.0*(2*tie_px*sin(om)*cos(fi)*cos(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(fi)*sin(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(-2*tie_px*cos(fi)*cos(ka)*cos(om) + 2*tie_py*sin(ka)*cos(fi)*cos(om) - 2*tie_pz*sin(fi)*cos(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) + (tie_px*sin(om)*cos(fi)*cos(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(fi)*sin(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
j.coeffRef(1,5) = -rows*((tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(2*tie_px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(2*tie_px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - 1.0/2.0*(-2*tie_px*sin(ka)*cos(fi) - 2*tie_py*cos(fi)*cos(ka))*(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi)))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
j.coeffRef(1,6) = -rows*((sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(2*sin(fi)*sin(om)*cos(ka) + 2*sin(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(-2*sin(fi)*cos(ka)*cos(om) + 2*sin(ka)*sin(om))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) - (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*cos(fi)*cos(ka))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
j.coeffRef(1,7) = -rows*((-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)) + (-1.0/2.0*(-2*sin(fi)*sin(ka)*sin(om) + 2*cos(ka)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi)) - 1.0/2.0*(2*sin(fi)*sin(ka)*cos(om) + 2*sin(om)*cos(ka))*(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om)) + (px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(ka)*cos(fi))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
j.coeffRef(1,8) = -rows*((-(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi))*sin(fi) + (py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))*sin(om)*cos(fi) - (pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om))*cos(fi)*cos(om))*(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi))/pow(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2), 3.0/2.0) - sin(om)*cos(fi)/sqrt(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2)))/(pi*sqrt(1 - pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2)/(pow(px + tie_px*cos(fi)*cos(ka) - tie_py*sin(ka)*cos(fi) + tie_pz*sin(fi), 2) + pow(py + tie_px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - tie_pz*sin(om)*cos(fi), 2) + pow(pz + tie_px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + tie_py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + tie_pz*cos(fi)*cos(om), 2))));
}