inline void observation_equation_perspective_camera_with_intrinsics_tait_bryan_wc(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double u_kp, double v_kp, double k1, double k2, double k3, double p1, double p2)
{delta.coeffRef(0,0) = -cx - fx*(2.0*p1*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + p2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om))) + u_kp;
delta.coeffRef(1,0) = -cy - fy*(p1*(3.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om))) + v_kp;
}inline void projection_perspective_camera_with_intrinsics_tait_bryan_wc(double &u, double &v, double fx, double fy, double cx, double cy, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double k1, double k2, double k3, double p1, double p2)
{u = cx + fx*(2.0*p1*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + p2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)));
v = cy + fy*(p1*(3.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)));
}
inline void observation_equation_perspective_camera_with_intrinsics_tait_bryan_wc_jacobian(Eigen::Matrix<double, 2, 14> &j, double fx, double fy, double px, double py, double pz, double om, double fi, double ka, double tie_px, double tie_py, double tie_pz, double k1, double k2, double k3, double p1, double p2)
{j.coeffRef(0,0) = -1.0*fx*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om));
j.coeffRef(0,1) = -1.0*fx*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om));
j.coeffRef(0,2) = -1.0*fx*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om));
j.coeffRef(0,3) = 0;
j.coeffRef(0,4) = 0;
j.coeffRef(0,5) = 0;
j.coeffRef(0,6) = -2.0*fx*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2);
j.coeffRef(0,7) = -fx*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,8) = -fx*(-2.0*p1*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*p1*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + p2*(2.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 6.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(k1*(2.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 2.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(4.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 4.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 4.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(6.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 6.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) - 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*cos(fi)*cos(ka)/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,9) = -fx*(2.0*p1*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 4.0*p1*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + p2*(1.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 4.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 4.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) - 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,10) = -fx*(2.0*p1*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*p1*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + p2*(1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 4.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,11) = -fx*(2.0*p1*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + p2*(1.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(k1*(1.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-py*cos(fi)*cos(om) - pz*sin(om)*cos(fi) + tie_py*cos(fi)*cos(om) + tie_pz*sin(om)*cos(fi))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,12) = -fx*(2.0*p1*(-px*sin(fi)*sin(ka) + py*sin(ka)*sin(om)*cos(fi) - pz*sin(ka)*cos(fi)*cos(om) + tie_px*sin(fi)*sin(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(ka)*cos(fi)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(px*sin(fi)*cos(ka) - py*sin(om)*cos(fi)*cos(ka) + pz*cos(fi)*cos(ka)*cos(om) - tie_px*sin(fi)*cos(ka) + tie_py*sin(om)*cos(fi)*cos(ka) - tie_pz*cos(fi)*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + p2*(1.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 1.0*(k1*(1.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(fi)*cos(ka) - py*sin(om)*cos(fi)*cos(ka) + pz*cos(fi)*cos(ka)*cos(om) - tie_px*sin(fi)*cos(ka) + tie_py*sin(om)*cos(fi)*cos(ka) - tie_pz*cos(fi)*cos(ka)*cos(om))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*cos(fi) + py*sin(fi)*sin(om) - pz*sin(fi)*cos(om) - tie_px*cos(fi) - tie_py*sin(fi)*sin(om) + tie_pz*sin(fi)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(0,13) = -fx*(2.0*p1*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p1*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*(px*cos(fi)*cos(ka) + py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tie_px*cos(fi)*cos(ka) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + p2*(1.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + 1.0*(k1*(1.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)));
j.coeffRef(1,0) = -1.0*fy*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om));
j.coeffRef(1,1) = -1.0*fy*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om));
j.coeffRef(1,2) = -1.0*fy*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om));
j.coeffRef(1,3) = 0;
j.coeffRef(1,4) = 0;
j.coeffRef(1,5) = 0;
j.coeffRef(1,6) = -fy*(3.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,7) = -2.0*fy*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2);
j.coeffRef(1,8) = -fy*(p1*(6.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 2.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) - 2.0*p2*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*p2*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(k1*(2.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 2.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(4.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 4.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 4.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(6.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(ka)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 6.0*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(ka)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*sin(ka)*cos(fi)/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,9) = -fy*(p1*(3.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 2.0*p2*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 4.0*p2*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om))*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 4.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 4.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*sin(fi)*sin(ka)*sin(om) - 2*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*sin(fi)*sin(om)*cos(ka) - 2*sin(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) - 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) - 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) - 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*sin(om)*cos(fi)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,10) = -fy*(p1*(3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 2.0*p2*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*p2*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 4.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 4.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*sin(fi)*sin(ka)*cos(om) - 2*sin(om)*cos(ka))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*sin(fi)*cos(ka)*cos(om) - 2*sin(ka)*sin(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 6.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 6.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*cos(fi)*cos(om)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,11) = -fy*(p1*(3.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 2.0*p2*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(k1*(1.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(2*py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + 2*pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*tie_pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(-2*py*cos(fi)*cos(om) - 2*pz*sin(om)*cos(fi) + 2*tie_py*cos(fi)*cos(om) + 2*tie_pz*sin(om)*cos(fi))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + pz*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + tie_py*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + tie_pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-py*cos(fi)*cos(om) - pz*sin(om)*cos(fi) + tie_py*cos(fi)*cos(om) + tie_pz*sin(om)*cos(fi))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,12) = -fy*(p1*(3.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + 2.0*p2*(-px*sin(fi)*sin(ka) + py*sin(ka)*sin(om)*cos(fi) - pz*sin(ka)*cos(fi)*cos(om) + tie_px*sin(fi)*sin(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(ka)*cos(fi)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(px*sin(fi)*cos(ka) - py*sin(om)*cos(fi)*cos(ka) + pz*cos(fi)*cos(ka)*cos(om) - tie_px*sin(fi)*cos(ka) + tie_py*sin(om)*cos(fi)*cos(ka) - tie_pz*cos(fi)*cos(ka)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(k1*(1.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 1.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 2.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(-2*px*sin(fi)*sin(ka) + 2*py*sin(ka)*sin(om)*cos(fi) - 2*pz*sin(ka)*cos(fi)*cos(om) + 2*tie_px*sin(fi)*sin(ka) - 2*tie_py*sin(ka)*sin(om)*cos(fi) + 2*tie_pz*sin(ka)*cos(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*sin(fi)*cos(ka) - 2*py*sin(om)*cos(fi)*cos(ka) + 2*pz*cos(fi)*cos(ka)*cos(om) - 2*tie_px*sin(fi)*cos(ka) + 2*tie_py*sin(om)*cos(fi)*cos(ka) - 2*tie_pz*cos(fi)*cos(ka)*cos(om))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3) + 3.0*(2*px*cos(fi) + 2*py*sin(fi)*sin(om) - 2*pz*sin(fi)*cos(om) - 2*tie_px*cos(fi) - 2*tie_py*sin(fi)*sin(om) + 2*tie_pz*sin(fi)*cos(om))*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 3)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(-px*sin(fi)*sin(ka) + py*sin(ka)*sin(om)*cos(fi) - pz*sin(ka)*cos(fi)*cos(om) + tie_px*sin(fi)*sin(ka) - tie_py*sin(ka)*sin(om)*cos(fi) + tie_pz*sin(ka)*cos(fi)*cos(om))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*cos(fi) + py*sin(fi)*sin(om) - pz*sin(fi)*cos(om) - tie_px*cos(fi) - tie_py*sin(fi)*sin(om) + tie_pz*sin(fi)*cos(om))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2));
j.coeffRef(1,13) = -fy*(p1*(3.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + 2.0*p2*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*p2*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*(px*cos(fi)*cos(ka) + py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tie_px*cos(fi)*cos(ka) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(k1*(1.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2))*(2.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 2.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2)*(3.0*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*px*cos(fi)*cos(ka) + 2*py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*tie_px*cos(fi)*cos(ka) + 2*tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 3.0*(2*px*sin(ka)*cos(fi) + 2*py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + 2*pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - 2*tie_px*sin(ka)*cos(fi) + 2*tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)))*(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)) + 1.0*(k1*(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2)) + k2*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 2) + k3*pow(1.0*pow(px*sin(ka)*cos(fi) + py*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) + pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) - tie_px*sin(ka)*cos(fi) + tie_py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + tie_pz*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2) + 1.0*pow(-px*cos(fi)*cos(ka) + py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + tie_px*cos(fi)*cos(ka) + tie_py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + tie_pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)/pow(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om), 2), 3) + 1)*(px*cos(fi)*cos(ka) + py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + pz*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - tie_px*cos(fi)*cos(ka) + tie_py*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + tie_pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)))/(-px*sin(fi) + py*sin(om)*cos(fi) - pz*cos(fi)*cos(om) + tie_px*sin(fi) - tie_py*sin(om)*cos(fi) + tie_pz*cos(fi)*cos(om)));
}