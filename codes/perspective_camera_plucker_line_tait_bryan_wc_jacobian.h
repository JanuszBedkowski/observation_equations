inline void observation_equation_perspective_camera_plucker_line_tait_bryan_wc(Eigen::Matrix<double, 2, 1> &delta, double fx, double fy, double cx, double cy, double px, double py, double pz, double om, double fi, double ka, double mx_w, double my_w, double mz_w, double lx_w, double ly_w, double lz_w, double u_s, double v_s, double u_e, double v_e)
{delta.coeffRef(0,0) = -(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2));
delta.coeffRef(1,0) = -(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2));
}
inline void observation_equation_perspective_camera_plucker_line_tait_bryan_wc_jacobian(Eigen::Matrix<double, 2, 6, Eigen::RowMajor> &j, double fx, double fy, double cx, double cy, double px, double py, double pz, double om, double fi, double ka, double mx_w, double my_w, double mz_w, double lx_w, double ly_w, double lz_w, double u_s, double v_s, double u_e, double v_e)
{j.coeffRef(0,0) = -(-cx*fy*(ly_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + lz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) - cy*fx*(ly_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + lz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fx*fy*(-ly_w*cos(fi)*cos(om) - lz_w*sin(om)*cos(fi)) + fx*v_s*(ly_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + lz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fy*u_s*(ly_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + lz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*ly_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*lz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*ly_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*lz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(0,1) = -(-cx*fy*(lx_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - lz_w*cos(fi)*cos(ka)) - cy*fx*(lx_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + lz_w*sin(ka)*cos(fi)) + fx*fy*(lx_w*cos(fi)*cos(om) - lz_w*sin(fi)) + fx*v_s*(lx_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + lz_w*sin(ka)*cos(fi)) + fy*u_s*(lx_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - lz_w*cos(fi)*cos(ka)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*lz_w*sin(ka)*cos(fi))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*lz_w*cos(fi)*cos(ka))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(0,2) = -(-cx*fy*(lx_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + ly_w*cos(fi)*cos(ka)) - cy*fx*(lx_w*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - ly_w*sin(ka)*cos(fi)) + fx*fy*(lx_w*sin(om)*cos(fi) + ly_w*sin(fi)) + fx*v_s*(lx_w*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - ly_w*sin(ka)*cos(fi)) + fy*u_s*(lx_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + ly_w*cos(fi)*cos(ka)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - 2*ly_w*sin(ka)*cos(fi))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*ly_w*cos(fi)*cos(ka))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(0,3) = -(-cx*fy*(lx_w*(py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - ly_w*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + lz_w*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + my_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + mz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) - cy*fx*(lx_w*(py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))) - ly_w*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + lz_w*px*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + my_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + mz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fx*fy*(lx_w*(-py*sin(om)*cos(fi) + pz*cos(fi)*cos(om)) + ly_w*px*sin(om)*cos(fi) - lz_w*px*cos(fi)*cos(om) - my_w*cos(fi)*cos(om) - mz_w*sin(om)*cos(fi)) + fx*v_s*(lx_w*(py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))) - ly_w*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + lz_w*px*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + my_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + mz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fy*u_s*(lx_w*(py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - ly_w*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + lz_w*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + my_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + mz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))) - 2*ly_w*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*lz_w*px*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*my_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*mz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - 2*ly_w*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*lz_w*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*my_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*mz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(0,4) = -(-cx*fy*(lx_w*(-py*cos(fi)*cos(ka)*cos(om) - pz*sin(om)*cos(fi)*cos(ka)) + ly_w*(px*cos(fi)*cos(ka)*cos(om) - pz*sin(fi)*cos(ka)) + lz_w*(px*sin(om)*cos(fi)*cos(ka) + py*sin(fi)*cos(ka)) - mx_w*sin(fi)*cos(ka) + my_w*sin(om)*cos(fi)*cos(ka) - mz_w*cos(fi)*cos(ka)*cos(om)) - cy*fx*(lx_w*(py*sin(ka)*cos(fi)*cos(om) + pz*sin(ka)*sin(om)*cos(fi)) + ly_w*(-px*sin(ka)*cos(fi)*cos(om) + pz*sin(fi)*sin(ka)) + lz_w*(-px*sin(ka)*sin(om)*cos(fi) - py*sin(fi)*sin(ka)) + mx_w*sin(fi)*sin(ka) - my_w*sin(ka)*sin(om)*cos(fi) + mz_w*sin(ka)*cos(fi)*cos(om)) + fx*fy*(lx_w*(-py*sin(fi)*cos(om) - pz*sin(fi)*sin(om)) + ly_w*(px*sin(fi)*cos(om) + pz*cos(fi)) + lz_w*(px*sin(fi)*sin(om) - py*cos(fi)) + mx_w*cos(fi) + my_w*sin(fi)*sin(om) - mz_w*sin(fi)*cos(om)) + fx*v_s*(lx_w*(py*sin(ka)*cos(fi)*cos(om) + pz*sin(ka)*sin(om)*cos(fi)) + ly_w*(-px*sin(ka)*cos(fi)*cos(om) + pz*sin(fi)*sin(ka)) + lz_w*(-px*sin(ka)*sin(om)*cos(fi) - py*sin(fi)*sin(ka)) + mx_w*sin(fi)*sin(ka) - my_w*sin(ka)*sin(om)*cos(fi) + mz_w*sin(ka)*cos(fi)*cos(om)) + fy*u_s*(lx_w*(-py*cos(fi)*cos(ka)*cos(om) - pz*sin(om)*cos(fi)*cos(ka)) + ly_w*(px*cos(fi)*cos(ka)*cos(om) - pz*sin(fi)*cos(ka)) + lz_w*(px*sin(om)*cos(fi)*cos(ka) + py*sin(fi)*cos(ka)) - mx_w*sin(fi)*cos(ka) + my_w*sin(om)*cos(fi)*cos(ka) - mz_w*cos(fi)*cos(ka)*cos(om)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*lx_w*(py*sin(ka)*cos(fi)*cos(om) + pz*sin(ka)*sin(om)*cos(fi)) + 2*ly_w*(-px*sin(ka)*cos(fi)*cos(om) + pz*sin(fi)*sin(ka)) + 2*lz_w*(-px*sin(ka)*sin(om)*cos(fi) - py*sin(fi)*sin(ka)) + 2*mx_w*sin(fi)*sin(ka) - 2*my_w*sin(ka)*sin(om)*cos(fi) + 2*mz_w*sin(ka)*cos(fi)*cos(om)) - 1.0/2.0*pow(fy, 2)*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*(2*lx_w*(-py*cos(fi)*cos(ka)*cos(om) - pz*sin(om)*cos(fi)*cos(ka)) + 2*ly_w*(px*cos(fi)*cos(ka)*cos(om) - pz*sin(fi)*cos(ka)) + 2*lz_w*(px*sin(om)*cos(fi)*cos(ka) + py*sin(fi)*cos(ka)) - 2*mx_w*sin(fi)*cos(ka) + 2*my_w*sin(om)*cos(fi)*cos(ka) - 2*mz_w*cos(fi)*cos(ka)*cos(om)))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(0,5) = -(-cx*fy*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - cy*fx*(lx_w*(py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + ly_w*(-px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*cos(fi)*cos(ka)) + lz_w*(px*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + py*cos(fi)*cos(ka)) - mx_w*cos(fi)*cos(ka) + my_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + mz_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + fx*v_s*(lx_w*(py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + ly_w*(-px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*cos(fi)*cos(ka)) + lz_w*(px*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + py*cos(fi)*cos(ka)) - mx_w*cos(fi)*cos(ka) + my_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + mz_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + fy*u_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*lx_w*(py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + 2*ly_w*(-px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*cos(fi)*cos(ka)) + 2*lz_w*(px*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + py*cos(fi)*cos(ka)) - 2*mx_w*cos(fi)*cos(ka) + 2*my_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*mz_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + 2*ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + 2*lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - 2*mx_w*sin(ka)*cos(fi) + 2*my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_s*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_s*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(1,0) = -(-cx*fy*(ly_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + lz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) - cy*fx*(ly_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + lz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fx*fy*(-ly_w*cos(fi)*cos(om) - lz_w*sin(om)*cos(fi)) + fx*v_e*(ly_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + lz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fy*u_e*(ly_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + lz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*ly_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*lz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*ly_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*lz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(1,1) = -(-cx*fy*(lx_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - lz_w*cos(fi)*cos(ka)) - cy*fx*(lx_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + lz_w*sin(ka)*cos(fi)) + fx*fy*(lx_w*cos(fi)*cos(om) - lz_w*sin(fi)) + fx*v_e*(lx_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + lz_w*sin(ka)*cos(fi)) + fy*u_e*(lx_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - lz_w*cos(fi)*cos(ka)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) + 2*lz_w*sin(ka)*cos(fi))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - 2*lz_w*cos(fi)*cos(ka))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(1,2) = -(-cx*fy*(lx_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + ly_w*cos(fi)*cos(ka)) - cy*fx*(lx_w*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - ly_w*sin(ka)*cos(fi)) + fx*fy*(lx_w*sin(om)*cos(fi) + ly_w*sin(fi)) + fx*v_e*(lx_w*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - ly_w*sin(ka)*cos(fi)) + fy*u_e*(lx_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + ly_w*cos(fi)*cos(ka)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(sin(fi)*sin(ka)*sin(om) - cos(ka)*cos(om)) - 2*ly_w*sin(ka)*cos(fi))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*ly_w*cos(fi)*cos(ka))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(1,3) = -(-cx*fy*(lx_w*(py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - ly_w*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + lz_w*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + my_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + mz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) - cy*fx*(lx_w*(py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))) - ly_w*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + lz_w*px*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + my_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + mz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fx*fy*(lx_w*(-py*sin(om)*cos(fi) + pz*cos(fi)*cos(om)) + ly_w*px*sin(om)*cos(fi) - lz_w*px*cos(fi)*cos(om) - my_w*cos(fi)*cos(om) - mz_w*sin(om)*cos(fi)) + fx*v_e*(lx_w*(py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))) - ly_w*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + lz_w*px*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + my_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + mz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + fy*u_e*(lx_w*(py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - ly_w*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + lz_w*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + my_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + mz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(2*lx_w*(py*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) - pz*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka))) - 2*ly_w*px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*lz_w*px*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*my_w*(-sin(fi)*sin(ka)*cos(om) - sin(om)*cos(ka)) + 2*mz_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)))*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(py*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - pz*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - 2*ly_w*px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + 2*lz_w*px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*my_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) + 2*mz_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(1,4) = -(-cx*fy*(lx_w*(-py*cos(fi)*cos(ka)*cos(om) - pz*sin(om)*cos(fi)*cos(ka)) + ly_w*(px*cos(fi)*cos(ka)*cos(om) - pz*sin(fi)*cos(ka)) + lz_w*(px*sin(om)*cos(fi)*cos(ka) + py*sin(fi)*cos(ka)) - mx_w*sin(fi)*cos(ka) + my_w*sin(om)*cos(fi)*cos(ka) - mz_w*cos(fi)*cos(ka)*cos(om)) - cy*fx*(lx_w*(py*sin(ka)*cos(fi)*cos(om) + pz*sin(ka)*sin(om)*cos(fi)) + ly_w*(-px*sin(ka)*cos(fi)*cos(om) + pz*sin(fi)*sin(ka)) + lz_w*(-px*sin(ka)*sin(om)*cos(fi) - py*sin(fi)*sin(ka)) + mx_w*sin(fi)*sin(ka) - my_w*sin(ka)*sin(om)*cos(fi) + mz_w*sin(ka)*cos(fi)*cos(om)) + fx*fy*(lx_w*(-py*sin(fi)*cos(om) - pz*sin(fi)*sin(om)) + ly_w*(px*sin(fi)*cos(om) + pz*cos(fi)) + lz_w*(px*sin(fi)*sin(om) - py*cos(fi)) + mx_w*cos(fi) + my_w*sin(fi)*sin(om) - mz_w*sin(fi)*cos(om)) + fx*v_e*(lx_w*(py*sin(ka)*cos(fi)*cos(om) + pz*sin(ka)*sin(om)*cos(fi)) + ly_w*(-px*sin(ka)*cos(fi)*cos(om) + pz*sin(fi)*sin(ka)) + lz_w*(-px*sin(ka)*sin(om)*cos(fi) - py*sin(fi)*sin(ka)) + mx_w*sin(fi)*sin(ka) - my_w*sin(ka)*sin(om)*cos(fi) + mz_w*sin(ka)*cos(fi)*cos(om)) + fy*u_e*(lx_w*(-py*cos(fi)*cos(ka)*cos(om) - pz*sin(om)*cos(fi)*cos(ka)) + ly_w*(px*cos(fi)*cos(ka)*cos(om) - pz*sin(fi)*cos(ka)) + lz_w*(px*sin(om)*cos(fi)*cos(ka) + py*sin(fi)*cos(ka)) - mx_w*sin(fi)*cos(ka) + my_w*sin(om)*cos(fi)*cos(ka) - mz_w*cos(fi)*cos(ka)*cos(om)))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*lx_w*(py*sin(ka)*cos(fi)*cos(om) + pz*sin(ka)*sin(om)*cos(fi)) + 2*ly_w*(-px*sin(ka)*cos(fi)*cos(om) + pz*sin(fi)*sin(ka)) + 2*lz_w*(-px*sin(ka)*sin(om)*cos(fi) - py*sin(fi)*sin(ka)) + 2*mx_w*sin(fi)*sin(ka) - 2*my_w*sin(ka)*sin(om)*cos(fi) + 2*mz_w*sin(ka)*cos(fi)*cos(om)) - 1.0/2.0*pow(fy, 2)*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)))*(2*lx_w*(-py*cos(fi)*cos(ka)*cos(om) - pz*sin(om)*cos(fi)*cos(ka)) + 2*ly_w*(px*cos(fi)*cos(ka)*cos(om) - pz*sin(fi)*cos(ka)) + 2*lz_w*(px*sin(om)*cos(fi)*cos(ka) + py*sin(fi)*cos(ka)) - 2*mx_w*sin(fi)*cos(ka) + 2*my_w*sin(om)*cos(fi)*cos(ka) - 2*mz_w*cos(fi)*cos(ka)*cos(om)))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
j.coeffRef(1,5) = -(-cx*fy*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) - cy*fx*(lx_w*(py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + ly_w*(-px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*cos(fi)*cos(ka)) + lz_w*(px*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + py*cos(fi)*cos(ka)) - mx_w*cos(fi)*cos(ka) + my_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + mz_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + fx*v_e*(lx_w*(py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + ly_w*(-px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*cos(fi)*cos(ka)) + lz_w*(px*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + py*cos(fi)*cos(ka)) - mx_w*cos(fi)*cos(ka) + my_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + mz_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) + fy*u_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))))/sqrt(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2)) - (-1.0/2.0*pow(fx, 2)*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(2*lx_w*(py*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om))) + 2*ly_w*(-px*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om)) - pz*cos(fi)*cos(ka)) + 2*lz_w*(px*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + py*cos(fi)*cos(ka)) - 2*mx_w*cos(fi)*cos(ka) + 2*my_w*(-sin(fi)*sin(om)*cos(ka) - sin(ka)*cos(om)) + 2*mz_w*(sin(fi)*cos(ka)*cos(om) - sin(ka)*sin(om))) - 1.0/2.0*pow(fy, 2)*(2*lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + 2*ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + 2*lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - 2*mx_w*sin(ka)*cos(fi) + 2*my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + 2*mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)))*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))*(-cx*fy*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))) - cy*fx*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fx*fy*(lx_w*(py*cos(fi)*cos(om) + pz*sin(om)*cos(fi)) + ly_w*(-px*cos(fi)*cos(om) + pz*sin(fi)) + lz_w*(-px*sin(om)*cos(fi) - py*sin(fi)) + mx_w*sin(fi) - my_w*sin(om)*cos(fi) + mz_w*cos(fi)*cos(om)) + fx*v_e*(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka))) + fy*u_e*(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om))))/pow(pow(fx, 2)*pow(lx_w*(py*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om))) + ly_w*(-px*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)) - pz*sin(ka)*cos(fi)) + lz_w*(px*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + py*sin(ka)*cos(fi)) - mx_w*sin(ka)*cos(fi) + my_w*(-sin(fi)*sin(ka)*sin(om) + cos(ka)*cos(om)) + mz_w*(sin(fi)*sin(ka)*cos(om) + sin(om)*cos(ka)), 2) + pow(fy, 2)*pow(lx_w*(py*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) - pz*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om))) + ly_w*(-px*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)) + pz*cos(fi)*cos(ka)) + lz_w*(px*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) - py*cos(fi)*cos(ka)) + mx_w*cos(fi)*cos(ka) + my_w*(sin(fi)*sin(om)*cos(ka) + sin(ka)*cos(om)) + mz_w*(-sin(fi)*cos(ka)*cos(om) + sin(ka)*sin(om)), 2), 3.0/2.0);
}